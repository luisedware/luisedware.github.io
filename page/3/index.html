<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>七月十五九月初七</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="七月十五九月初七">
<meta property="og:url" content="http://luisedware.github.io/page/3/index.html">
<meta property="og:site_name" content="七月十五九月初七">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="七月十五九月初七">
  
    <link rel="alternate" href="/atom.xml" title="七月十五九月初七" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
  

</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">七月十五九月初七</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">一两祝你手边多银财，二两祝你方寸永不乱</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Søk"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://luisedware.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-学习-UML（二）" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/02/17/学习-UML（二）/" class="article-date">
  <time datetime="2017-02-17T09:36:39.000Z" itemprop="datePublished">2017-02-17</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/UML/">UML</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/02/17/学习-UML（二）/">学习 UML（二）</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="类图"><a href="#类图" class="headerlink" title="类图"></a>类图</h2><p>类图（class diagram）只是 UML 的一部分，但它们可能是最常用的，因为类图在描述面向对象关系时非常有用。</p>
<h4 id="类、抽象类、接口"><a href="#类、抽象类、接口" class="headerlink" title="类、抽象类、接口"></a>类、抽象类、接口</h4><p>类是类图的主要部分。类用带有类名的方框来描述，如下图所示：</p>
<p><img src="http://olnw31eni.bkt.clouddn.com/uml%E7%B1%BB.png" alt=""></p>
<p>抽象类通常使用斜体的类名，或者增加 <code>{abstract}</code> 到类名下来表示，如下图所示：</p>
<p><img src="http://olnw31eni.bkt.clouddn.com/uml%E6%8A%BD%E8%B1%A1%E7%B1%BB.png" alt=""></p>
<p>接口的定义方式和类相同，但接口必须增加 <code>&lt;&lt;interface&gt;&gt;</code> 到类名上来表示，如下图所示：</p>
<p><img src="http://olnw31eni.bkt.clouddn.com/uml%E6%8E%A5%E5%8F%A3.png" alt=""></p>
<h4 id="属性"><a href="#属性" class="headerlink" title="属性"></a>属性</h4><p>属性用于描述一个类的属性，属性直接列在类名下面的格子中。属性使用符号来表示类属性的可见性，其中 <code>+</code> 对应 <code>public</code> 、<code>-</code> 对应 <code>private</code>、<code>#</code> 对应 <code>protected</code>，如下图所示：</p>
<p><img src="http://olnw31eni.bkt.clouddn.com/uml%E5%B1%9E%E6%80%A7.png" alt=""></p>
<h4 id="操作"><a href="#操作" class="headerlink" title="操作"></a>操作</h4><p>操作用于描述类方法，操作表示类方法可见性的办法与属性一致。类方法有参数，则包含在括号之中；类方法有返回类型，则用冒号来描述，如下图所示：</p>
<p><img src="http://olnw31eni.bkt.clouddn.com/uml%E6%93%8D%E4%BD%9C.png" alt=""></p>
<h4 id="继承"><a href="#继承" class="headerlink" title="继承"></a>继承</h4><p>UML 一般用「泛化」来描述继承关系。这个关系用从子类到父类的一条线来标识，线的顶端有一个空心闭合箭头，如下图所示：</p>
<p><img src="http://olnw31eni.bkt.clouddn.com/uml%E7%BB%A7%E6%89%BF.png" alt=""></p>
<h4 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h4><p>UML 用「实现」来描述接口和实现接口的类之间的关系。这个关系用从实现接口的类到接口的一条虚线来标识，线的顶端有一个空心闭合箭头，如下图所示：</p>
<p><img src="http://olnw31eni.bkt.clouddn.com/uml%E5%AE%9E%E7%8E%B0.png" alt=""></p>
<h4 id="关联"><a href="#关联" class="headerlink" title="关联"></a>关联</h4><p>当一个类的属性保存了对另一个类的一个实例或多个实例的引用时，就产生了关联。类之间的关联有单向关联、双向关联和多个引用关联，如下图所示：</p>
<p><img src="http://olnw31eni.bkt.clouddn.com/uml%E5%85%B3%E8%81%94.png" alt=""></p>
<h4 id="聚合和组合"><a href="#聚合和组合" class="headerlink" title="聚合和组合"></a>聚合和组合</h4><p>聚合和组合都描述了一个类长期持有其他类的一个或多个实例的情况。通过聚合或组合，被引用的对象实例成为引用对象的一部分。</p>
<p>聚合的情况下，被包含对象是容器的一个核心部分，但是它们也可以同时被其他对象所包含。聚合关系用一条空心菱形开头的线来说明。</p>
<p>组合则是一个更强的关系。在组合中，被包含对象只能被它的容器所引用。当容器被删除时，它也应该被删除。组合关系可以用类聚合关系的方式描述，但是菱形必须是实心的。</p>
<p><img src="http://olnw31eni.bkt.clouddn.com/uml%E8%81%9A%E5%90%88.png" alt=""><br><img src="http://olnw31eni.bkt.clouddn.com/uml%E7%BB%84%E5%90%88.png" alt=""></p>
<h4 id="描述使用"><a href="#描述使用" class="headerlink" title="描述使用"></a>描述使用</h4><p>一个对象使用另一个对象的关系在 UML 中被描述为一个依赖关系。一个被使用的类可以作为类方法的参数传递或者作为方法调用的结果得到。</p>
<p><img src="http://olnw31eni.bkt.clouddn.com/uml%E6%8F%8F%E8%BF%B0%E4%BD%BF%E7%94%A8.png" alt=""></p>
<h4 id="使用注解"><a href="#使用注解" class="headerlink" title="使用注解"></a>使用注解</h4><p>类图可以捕捉到系统的结构，但类图并不能解释类处理任务的过程，可以通过使用注解来补充说明。注解由一个折角的方框组成。它通常包含伪代码片段。注解使类图变得易于理解。</p>
<p><img src="http://olnw31eni.bkt.clouddn.com/uml%E6%B3%A8%E9%87%8A.png" alt=""></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://luisedware.github.io/2017/02/17/学习-UML（二）/" data-id="cj3gyqve3006uxo4b65j0il2y" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/UML/">UML</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-在-Yii-2-中使用-CodeCeption" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/02/14/在-Yii-2-中使用-CodeCeption/" class="article-date">
  <time datetime="2017-02-14T06:43:55.000Z" itemprop="datePublished">2017-02-14</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/PHP/">PHP</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/02/14/在-Yii-2-中使用-CodeCeption/">在 Yii 2 中使用 CodeCeption</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="安装-Yii2"><a href="#安装-Yii2" class="headerlink" title="安装 Yii2"></a>安装 Yii2</h2><p>使用 Composer 安装 Yii 2 高级模板项目<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">sudo composer global require &quot;fxp/composer-asset-plugin:^1.2.0&quot;</div><div class="line">sudo composer create-project --prefer-dist yiisoft/yii2-app-advanced yii-application</div><div class="line">cd yii-application</div><div class="line">sudo composer install</div></pre></td></tr></table></figure></p>
<p>配置 Apache 服务器<br><figure class="highlight apache"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div></pre></td><td class="code"><pre><div class="line"><span class="section">&lt;VirtualHost *:80&gt;</span></div><div class="line">   <span class="attribute"><span class="nomarkup">ServerName</span></span> frontend.dev</div><div class="line">   <span class="attribute"><span class="nomarkup">DocumentRoot</span></span> <span class="string">"/path/to/yii-application/frontend/web/"</span></div><div class="line"></div><div class="line">   <span class="section">&lt;Directory "/path/to/yii-application/frontend/web/"&gt;</span></div><div class="line">       <span class="comment"># use mod_rewrite for pretty URL support</span></div><div class="line">       <span class="attribute"><span class="nomarkup">RewriteEngine</span></span> <span class="literal">on</span></div><div class="line">       <span class="comment"># If a directory or a file exists, use the request directly</span></div><div class="line">       <span class="attribute"><span class="nomarkup">RewriteCond</span></span> <span class="variable">%&#123;REQUEST_FILENAME&#125;</span> !-f</div><div class="line">       <span class="attribute"><span class="nomarkup">RewriteCond</span></span> <span class="variable">%&#123;REQUEST_FILENAME&#125;</span> !-d</div><div class="line">       <span class="comment"># Otherwise forward the request to index.php</span></div><div class="line">       <span class="attribute"><span class="nomarkup">RewriteRule</span></span> . index.php</div><div class="line"></div><div class="line">       <span class="comment"># use index.php as index file</span></div><div class="line">       <span class="attribute">DirectoryIndex</span> index.php</div><div class="line"></div><div class="line">       <span class="comment"># ...other settings...</span></div><div class="line">       <span class="comment"># Apache 2.4</span></div><div class="line">       <span class="attribute">Require</span> <span class="literal">all</span> granted</div><div class="line"></div><div class="line">       <span class="comment">## Apache 2.2</span></div><div class="line">       <span class="comment"># Order allow,deny</span></div><div class="line">       <span class="comment"># Allow from all</span></div><div class="line">   <span class="section">&lt;/Directory&gt;</span></div><div class="line"><span class="section">&lt;/VirtualHost&gt;</span></div><div class="line"></div><div class="line"><span class="section">&lt;VirtualHost *:80&gt;</span></div><div class="line">   <span class="attribute"><span class="nomarkup">ServerName</span></span> backend.dev</div><div class="line">   <span class="attribute"><span class="nomarkup">DocumentRoot</span></span> <span class="string">"/path/to/yii-application/backend/web/"</span></div><div class="line"></div><div class="line">   <span class="section">&lt;Directory "/path/to/yii-application/backend/web/"&gt;</span></div><div class="line">       <span class="comment"># use mod_rewrite for pretty URL support</span></div><div class="line">       <span class="attribute"><span class="nomarkup">RewriteEngine</span></span> <span class="literal">on</span></div><div class="line">       <span class="comment"># If a directory or a file exists, use the request directly</span></div><div class="line">       <span class="attribute"><span class="nomarkup">RewriteCond</span></span> <span class="variable">%&#123;REQUEST_FILENAME&#125;</span> !-f</div><div class="line">       <span class="attribute"><span class="nomarkup">RewriteCond</span></span> <span class="variable">%&#123;REQUEST_FILENAME&#125;</span> !-d</div><div class="line">       <span class="comment"># Otherwise forward the request to index.php</span></div><div class="line">       <span class="attribute"><span class="nomarkup">RewriteRule</span></span> . index.php</div><div class="line"></div><div class="line">       <span class="comment"># use index.php as index file</span></div><div class="line">       <span class="attribute">DirectoryIndex</span> index.php</div><div class="line"></div><div class="line">       <span class="comment"># ...other settings...</span></div><div class="line">       <span class="comment"># Apache 2.4</span></div><div class="line">       <span class="attribute">Require</span> <span class="literal">all</span> granted</div><div class="line"></div><div class="line">       <span class="comment">## Apache 2.2</span></div><div class="line">       <span class="comment"># Order allow,deny</span></div><div class="line">       <span class="comment"># Allow from all</span></div><div class="line">   <span class="section">&lt;/Directory&gt;</span></div><div class="line"><span class="section">&lt;/VirtualHost&gt;</span></div></pre></td></tr></table></figure></p>
<h2 id="安装-Codeception"><a href="#安装-Codeception" class="headerlink" title="安装 Codeception"></a>安装 Codeception</h2><p>在项目根目录执行以下命令安装 codeception 扩展<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">sudo composer global require &quot;codeception/codeception=*&quot;</div><div class="line">sudo composer global require &quot;codeception/specify=*&quot;</div><div class="line">sudo composer global require &quot;codeception/verify=*&quot;</div><div class="line">sudo composer require --dev &quot;yiisoft/yii2-faker=*&quot;</div></pre></td></tr></table></figure></p>
<p>将 codeception 命令配置进环境变量中<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">vim .zshrc</div><div class="line"></div><div class="line">// 在文件 .zshrc 中添加以下代码，且保存退出</div><div class="line">alias codecept=&quot;/Users/LuisEdware/.composer/vendor/codeception/codeception/codecept&quot;</div><div class="line"></div><div class="line">source .zshrc</div></pre></td></tr></table></figure></p>
<p>在项目中使用 codeception<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">cd frontend/</div><div class="line">sudo chmod -R 777 tests</div><div class="line">codecept build</div><div class="line">codecept run</div></pre></td></tr></table></figure></p>
<h2 id="单元测试（Unit-Test）"><a href="#单元测试（Unit-Test）" class="headerlink" title="单元测试（Unit Test）"></a>单元测试（Unit Test）</h2><p>单元测试是针对程序模块来进行正确性检验的测试工作，可以通过单元测试来确认深藏在代码里面的某些功能仍然可用, 单元测试能消除程序单元的不可靠性。</p>
<p>Codeception 的单元测试功能是基于 PHPUnit 之上的, 你可以照样写 PHPUnit 的测试代码, Codeception 一样能运行。</p>
<h4 id="创建单元测试"><a href="#创建单元测试" class="headerlink" title="创建单元测试"></a>创建单元测试</h4><p>使用 Codeception 的生成器来执行以下命令生成单元测试<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">cd frontend</div><div class="line">codecept generate:test unit Example</div></pre></td></tr></table></figure></p>
<p>上述命令会在 tests/unit 目录创建一个 ExampleTest 文件，代码如下：<br><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"><span class="keyword">namespace</span> <span class="title">frontend</span>\<span class="title">tests</span>;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">ExampleTest</span> <span class="keyword">extends</span> \<span class="title">Codeception</span>\<span class="title">Test</span>\<span class="title">Unit</span></span></div><div class="line">&#123;</div><div class="line">    <span class="comment">/**</span></div><div class="line">     * <span class="doctag">@var</span> \frontend\tests\UnitTester</div><div class="line">     */</div><div class="line">    <span class="keyword">protected</span> $tester;</div><div class="line"></div><div class="line">    <span class="keyword">protected</span> <span class="function"><span class="keyword">function</span> <span class="title">_before</span><span class="params">()</span></span></div><div class="line">    &#123;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">protected</span> <span class="function"><span class="keyword">function</span> <span class="title">_after</span><span class="params">()</span></span></div><div class="line">    &#123;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">testPushAndPop</span><span class="params">()</span></span></div><div class="line">    &#123;</div><div class="line">        $stack = [];</div><div class="line">        <span class="keyword">$this</span>-&gt;assertEquals(<span class="number">0</span>, count($stack));</div><div class="line"></div><div class="line">        array_push($stack, <span class="string">'foo'</span>);</div><div class="line">        <span class="keyword">$this</span>-&gt;assertEquals(<span class="string">'foo'</span>, $stack[count($stack)<span class="number">-1</span>]);</div><div class="line">        <span class="keyword">$this</span>-&gt;assertEquals(<span class="number">1</span>, count($stack));</div><div class="line"></div><div class="line">        <span class="keyword">$this</span>-&gt;assertEquals(<span class="string">'foo'</span>, array_pop($stack));</div><div class="line">        <span class="keyword">$this</span>-&gt;assertEquals(<span class="number">0</span>, count($stack));</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h6 id="测试依赖"><a href="#测试依赖" class="headerlink" title="测试依赖"></a>测试依赖</h6><p>通过 <code>@depends</code> 让测试方法之间进行关联依赖</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"><span class="keyword">namespace</span> <span class="title">frontend</span>\<span class="title">tests</span>;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">ExampleTest</span> <span class="keyword">extends</span> \<span class="title">Codeception</span>\<span class="title">Test</span>\<span class="title">Unit</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">testEmpty</span><span class="params">()</span></span></div><div class="line">    &#123;</div><div class="line">        $stack = [];</div><div class="line">        <span class="keyword">$this</span>-&gt;assertEmpty($stack);</div><div class="line"></div><div class="line">        <span class="keyword">return</span> $stack;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * <span class="doctag">@depends</span> testEmpty</div><div class="line">     */</div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">testPush</span><span class="params">(array $stack)</span></span></div><div class="line">    &#123;</div><div class="line">        array_push($stack, <span class="string">'foo'</span>);</div><div class="line">        <span class="keyword">$this</span>-&gt;assertEquals(<span class="string">'foo'</span>, $stack[count($stack)<span class="number">-1</span>]);</div><div class="line">        <span class="keyword">$this</span>-&gt;assertNotEmpty($stack);</div><div class="line"></div><div class="line">        <span class="keyword">return</span> $stack;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * <span class="doctag">@depends</span> testPush</div><div class="line">     */</div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">testPop</span><span class="params">(array $stack)</span></span></div><div class="line">    &#123;</div><div class="line">        <span class="keyword">$this</span>-&gt;assertEquals(<span class="string">'foo'</span>, array_pop($stack));</div><div class="line">        <span class="keyword">$this</span>-&gt;assertEmpty($stack);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h6 id="数据提供商"><a href="#数据提供商" class="headerlink" title="数据提供商"></a>数据提供商</h6><p>通过 <code>@dataProvider</code> 让测试方法迭代运行数据提供者方法的数据</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"><span class="keyword">namespace</span> <span class="title">frontend</span>\<span class="title">tests</span>;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">DataTest</span> <span class="keyword">extends</span> \<span class="title">Codeception</span>\<span class="title">Test</span>\<span class="title">Unit</span></span></div><div class="line">&#123;</div><div class="line">    <span class="comment">/**</span></div><div class="line">     * <span class="doctag">@var</span> \frontend\tests\UnitTester</div><div class="line">     */</div><div class="line">    <span class="keyword">protected</span> $tester;</div><div class="line"></div><div class="line">    <span class="keyword">protected</span> <span class="function"><span class="keyword">function</span> <span class="title">_before</span><span class="params">()</span></span></div><div class="line">    &#123;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">protected</span> <span class="function"><span class="keyword">function</span> <span class="title">_after</span><span class="params">()</span></span></div><div class="line">    &#123;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * <span class="doctag">@dataProvider</span> additionProvider</div><div class="line">     */</div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">testAdd</span><span class="params">($a, $b, $expected)</span></span></div><div class="line">    &#123;</div><div class="line">        <span class="keyword">echo</span> $a;</div><div class="line">        <span class="keyword">echo</span> $b;</div><div class="line">        <span class="keyword">echo</span> $expected;</div><div class="line">        <span class="keyword">$this</span>-&gt;assertEquals($expected, $a + $b);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">additionProvider</span><span class="params">()</span></span></div><div class="line">    &#123;</div><div class="line">        <span class="keyword">return</span> [</div><div class="line">            [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>],</div><div class="line">            [<span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>],</div><div class="line">            [<span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>],</div><div class="line">            [<span class="number">1</span>, <span class="number">1</span>, <span class="number">2</span>]</div><div class="line">        ];</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h6 id="抛出异常"><a href="#抛出异常" class="headerlink" title="抛出异常"></a>抛出异常</h6><p>通过 <code>@expectedException</code> 或方法 <code>$this-&gt;expectException()</code> 在测试实例中抛出异常</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"><span class="keyword">namespace</span> <span class="title">frontend</span>\<span class="title">tests</span>;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">ExceptionTest</span> <span class="keyword">extends</span> \<span class="title">Codeception</span>\<span class="title">Test</span>\<span class="title">Unit</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">testException</span><span class="params">()</span></span></div><div class="line">    &#123;</div><div class="line">        <span class="keyword">$this</span>-&gt;expectException(InvalidArgumentException::class);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * <span class="doctag">@expectedException</span> InvalidArgumentException</div><div class="line">     */</div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">testExceptionTow</span><span class="params">()</span></span></div><div class="line">    &#123;</div><div class="line"></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h6 id="断点输出"><a href="#断点输出" class="headerlink" title="断点输出"></a>断点输出</h6><p>通过方法 <code>$this-&gt;expectOutputString()</code> 生成一个预期的输出。当实际输出和预期输出不一致时，则测试不通过。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"><span class="keyword">use</span> <span class="title">PHPUnit</span>\<span class="title">Framework</span>\<span class="title">TestCase</span>;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">OutputTest</span> <span class="keyword">extends</span> <span class="title">TestCase</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">testExpectFooActualFoo</span><span class="params">()</span></span></div><div class="line">    &#123;</div><div class="line">        <span class="keyword">$this</span>-&gt;expectOutputString(<span class="string">'foo'</span>);</div><div class="line">        <span class="keyword">print</span> <span class="string">'foo'</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">testExpectBarActualBaz</span><span class="params">()</span></span></div><div class="line">    &#123;</div><div class="line">        <span class="keyword">$this</span>-&gt;expectOutputString(<span class="string">'bar'</span>);</div><div class="line">        <span class="keyword">print</span> <span class="string">'baz'</span>;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Codeception 的更多 Unit Tests 信息请参考链接：</p>
<ul>
<li><a href="https://github.com/Codeception/Codeception/blob/2.0/docs/06-UnitTests.md" target="_blank" rel="external">https://github.com/Codeception/Codeception/blob/2.0/docs/06-UnitTests.md</a></li>
<li><a href="https://github.com/Codeception/Codeception/blob/2.0/docs/modules/Yii2.md" target="_blank" rel="external">https://github.com/Codeception/Codeception/blob/2.0/docs/modules/Yii2.md</a></li>
</ul>
<h2 id="创建接口测试（RESTFUL-API-TEST）"><a href="#创建接口测试（RESTFUL-API-TEST）" class="headerlink" title="创建接口测试（RESTFUL API TEST）"></a>创建接口测试（RESTFUL API TEST）</h2><p>创建 RESTFUL API 测试配置文件，新增文件 <code>api.suite.yml</code> 和文件夹 <code>api</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">codecept generate:suite api</div></pre></td></tr></table></figure></p>
<p>修改配置文件 <code>api.suite.yml</code> 如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">class_name: ApiTester</div><div class="line">modules:</div><div class="line">    enabled:</div><div class="line">        - REST:</div><div class="line">            url: www.frontend.dev/index.php?r=</div><div class="line">            depends: Yii2</div><div class="line">        - \ApiBundle\Helper\Api</div><div class="line">    config:</div><div class="line">        - Yii2</div></pre></td></tr></table></figure></p>
<p>创建 RESTFUL API 测试文件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">codecept generate:cept api CreateUser</div></pre></td></tr></table></figure></p>
<p>修改生成文件代码如下：<br><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"><span class="keyword">use</span> <span class="title">frontend</span>\<span class="title">tests</span>\<span class="title">ApiTester</span>;</div><div class="line"></div><div class="line"><span class="comment">// 发送 HTTP GET 请求</span></div><div class="line">$I = <span class="keyword">new</span> ApiTester($scenario);</div><div class="line">$I-&gt;wantTo(<span class="string">'I want to test RESTFUL API'</span>);</div><div class="line">$I-&gt;sendGET(<span class="string">'/api/v1/users/create'</span>);</div><div class="line">$I-&gt;seeResponseCodeIs(\Codeception\Util\HttpCode::OK);</div><div class="line">$I-&gt;seeResponseIsJson();</div><div class="line">$I-&gt;seeResponseContains(<span class="string">'&#123;"result":"ok"&#125;'</span>);</div><div class="line"></div><div class="line"><span class="comment">// 发送 HTTP POST 请求</span></div><div class="line">$I-&gt;sendPOST(<span class="string">'/users'</span>, [<span class="string">'name'</span> =&gt; <span class="string">'davert'</span>, <span class="string">'email'</span> =&gt; <span class="string">'davert@codeception.com'</span>]);</div><div class="line"></div><div class="line"><span class="comment">// 验证 JSON 响应数据类型</span></div><div class="line">$I-&gt;seeResponseMatchesJsonType([</div><div class="line">    <span class="string">'id'</span> =&gt; <span class="string">'integer'</span>,</div><div class="line">    <span class="string">'name'</span> =&gt; <span class="string">'string'</span>,</div><div class="line">    <span class="string">'email'</span> =&gt; <span class="string">'string:email'</span>,</div><div class="line">    <span class="string">'homepage'</span> =&gt; <span class="string">'string:url|null'</span>,</div><div class="line">    <span class="string">'created_at'</span> =&gt; <span class="string">'string:date'</span>,</div><div class="line">    <span class="string">'is_active'</span> =&gt; <span class="string">'boolean'</span></div><div class="line">]);</div></pre></td></tr></table></figure></p>
<p>常用的 REST API 如下：</p>
<ul>
<li>wantTo()：配置测试标题</li>
<li>sendGET()：发送 HTTP GET 请求</li>
<li>sendPUT()：发送 HTTP PUT 请求</li>
<li>sendPOST()：发送 HTTP POST 请求</li>
<li>sendDELETE()：发送 HTTP DELETE 请求</li>
<li>haveHttpHeader()：设置 HTTP 请求头</li>
<li>seeHttpHeader()：检查 HTTP 请求头</li>
<li>seeResponseCodeIs()：检查响应状态码</li>
<li>seeResponseContains()：检查响应内容</li>
<li>seeResponseContainsJson()：检查响应数据类型是否为 JSON 和核对响应内容</li>
<li>seeResponseIsJson()：检查响应是否返回 JSON 数据</li>
<li>seeResponseJsonMatchesJsonPath()：使用 JSON 数据去检查响应内容</li>
<li>seeResponseMatchesJsonType()：检查响应数据的数据类型</li>
</ul>
<p>Codeception 的更多 RESTFUL API 信息请参考链接：</p>
<ul>
<li><a href="https://github.com/Codeception/Codeception/blob/2.0/docs/modules/REST.md" target="_blank" rel="external">https://github.com/Codeception/Codeception/blob/2.0/docs/modules/REST.md</a></li>
<li><a href="https://github.com/Codeception/Codeception/blob/2.0/docs/10-WebServices.md" target="_blank" rel="external">https://github.com/Codeception/Codeception/blob/2.0/docs/10-WebServices.md</a></li>
</ul>
<h2 id="数据库测试（DB-TEST）"><a href="#数据库测试（DB-TEST）" class="headerlink" title="数据库测试（DB TEST）"></a>数据库测试（DB TEST）</h2><p>常用的 DB TEST API 如下：</p>
<ul>
<li>seeInDatabase()</li>
<li>dontSeeInDatabase()</li>
<li>haveInDatabase()</li>
<li>grabFromDatabase()</li>
</ul>
<p>示例代码如下：<br><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"><span class="comment">// 检查 User 表是否存在 'username' 为 'Davert', 'email' 为 'davert@mail.com' 的数据，存在则报错</span></div><div class="line">$I-&gt;dontSeeInDatabase(<span class="string">'user'</span>, [<span class="string">'username'</span> =&gt; <span class="string">'Davert'</span>, <span class="string">'email'</span> =&gt; <span class="string">'davert@mail.com'</span>]);</div><div class="line"></div><div class="line"><span class="comment">// 检查 User 表是否存在 'username' 为 'okirlin', 'email' 为 'brady.renner@rutherford.com' 的数据，不存在则报错</span></div><div class="line">$I-&gt;seeInDatabase(<span class="string">'user'</span>, [<span class="string">'username'</span> =&gt; <span class="string">'okirlin'</span>, <span class="string">'email'</span> =&gt; <span class="string">'brady.renner@rutherford.com'</span>]);</div><div class="line"></div><div class="line"><span class="comment">// 检查 User 表是否能够新增以下数据，无法新增则报错</span></div><div class="line">$I-&gt;haveInDatabase(<span class="string">'user'</span>,</div><div class="line">  [</div><div class="line">    <span class="string">'username'</span> =&gt; <span class="string">'miles'</span>,</div><div class="line">    <span class="string">'email'</span> =&gt; <span class="string">'miles@davis.com'</span>,</div><div class="line">    <span class="string">'auth_key'</span> =&gt; <span class="string">'EdKfXrx88weFMV0vIxuTMWKgfK2tS321'</span>,</div><div class="line">    <span class="string">'password_hash'</span> =&gt; <span class="string">'$2y$13$g5nv41Px7VBqhS3hVsVN2.MKfgT3jFdkXEsMC4rQJLfaMa7VaJqL2'</span>,</div><div class="line">    <span class="string">'password_reset_token'</span> =&gt; <span class="string">'4BSNyiZNAuxjs5Mty990c47sVrgllIi_1487317115'</span>,</div><div class="line">    <span class="string">'email'</span> =&gt; <span class="string">'506510463@qq.com'</span>,</div><div class="line">    <span class="string">'role'</span> =&gt; <span class="number">10</span>,</div><div class="line">    <span class="string">'status'</span> =&gt; <span class="number">0</span>,</div><div class="line">    <span class="string">'created_at'</span> =&gt; <span class="number">1391885313</span>,</div><div class="line">    <span class="string">'updated_at'</span> =&gt; <span class="number">1391885313</span>,</div><div class="line">]);</div><div class="line"></div><div class="line"><span class="comment">// 按照正序获取一条 username = miles 的数据的 email 字段值</span></div><div class="line">$mail = $I-&gt;grabFromDatabase(<span class="string">'user'</span>, <span class="string">'email'</span>, <span class="keyword">array</span>(<span class="string">'username'</span> =&gt; <span class="string">'troy.becker'</span>));</div><div class="line">var_dump($mail);<span class="keyword">exit</span>;</div></pre></td></tr></table></figure></p>
<p>Codeception 的更多 DB TEST API 信息请参考链接：</p>
<ul>
<li>DB：<a href="https://github.com/Codeception/Codeception/blob/2.0/docs/modules/Db.md" target="_blank" rel="external">https://github.com/Codeception/Codeception/blob/2.0/docs/modules/Db.md</a></li>
<li>DBH：<a href="https://github.com/Codeception/Codeception/blob/2.0/docs/modules/Dbh.md" target="_blank" rel="external">https://github.com/Codeception/Codeception/blob/2.0/docs/modules/Dbh.md</a></li>
<li>Doctrine1：<a href="https://github.com/Codeception/Codeception/blob/2.0/docs/modules/Doctrine1.md" target="_blank" rel="external">https://github.com/Codeception/Codeception/blob/2.0/docs/modules/Doctrine1.md</a></li>
<li>Doctrine2：<a href="https://github.com/Codeception/Codeception/blob/2.0/docs/modules/Doctrine2.md" target="_blank" rel="external">https://github.com/Codeception/Codeception/blob/2.0/docs/modules/Doctrine2.md</a></li>
<li>Working with Data：<a href="https://github.com/Codeception/Codeception/blob/2.0/docs/09-Data.md" target="_blank" rel="external">https://github.com/Codeception/Codeception/blob/2.0/docs/09-Data.md</a></li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://luisedware.github.io/2017/02/14/在-Yii-2-中使用-CodeCeption/" data-id="cj3gyqvdo005zxo4bwz7ejkx6" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Yii/">Yii</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-LuisEdware-版-PHP-编程规范（遵循-PSR-1-PSR-2）" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/02/11/LuisEdware-版-PHP-编程规范（遵循-PSR-1-PSR-2）/" class="article-date">
  <time datetime="2017-02-11T08:23:06.000Z" itemprop="datePublished">2017-02-11</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/PHP/">PHP</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/02/11/LuisEdware-版-PHP-编程规范（遵循-PSR-1-PSR-2）/">LuisEdware 版 PHP 编程规范（遵循 PSR-1/PSR-2）</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="目录"><a href="#目录" class="headerlink" title="目录"></a>目录</h2><ol>
<li><a href="#1">八荣八耻</a></li>
<li><a href="#2">代码风格</a></li>
<li><a href="#3">目录与文件</a></li>
<li><a href="#4">函数、成员属性、成员方法</a></li>
<li><a href="#5">数据表和字段</a></li>
<li><a href="#6">常量和配置</a></li>
<li><a href="#7">示例代码</a></li>
<li><a href="#8">参考链接</a></li>
</ol>
<h2 id="八荣八耻"><a href="#八荣八耻" class="headerlink" title="八荣八耻"></a><a id="1">八荣八耻</a></h2><ul>
<li>以「<b>动手实践</b>」为荣, 以「<b>只看不练</b>」为耻;</li>
<li>以「<b>打印日志</b>」为荣, 以「<b>单步跟踪</b>」为耻;</li>
<li>以「<b>空格缩进</b>」为荣, 以「<b>制表缩进</b>」为耻;</li>
<li>以「<b>单元测试</b>」为荣, 以「<b>人工测试</b>」为耻;</li>
<li>以「<b>模块复用</b>」为荣, 以「<b>复制粘贴</b>」为耻;</li>
<li>以「<b>多态应用</b>」为荣, 以「<b>分支判断</b>」为耻;</li>
<li>以「<b>优雅高效</b>」为荣, 以「<b>冗余拖沓</b>」为耻;</li>
<li>以「<b>总结分享</b>」为荣, 以「<b>跪求其解</b>」为耻。</li>
</ul>
<h2 id="代码风格"><a href="#代码风格" class="headerlink" title="代码风格"></a><a id="2">代码风格</a></h2><p>编程开发时，需要遵循 PSR 规范如下：</p>
<ul>
<li>PSR 2（编码风格规范）：<a href="https://laravel-china.org/topics/2079" target="_blank" rel="external">https://laravel-china.org/topics/2079</a></li>
<li>PSR 4（自动加载规范）：<a href="https://laravel-china.org/topics/2081" target="_blank" rel="external">https://laravel-china.org/topics/2081</a></li>
</ul>
<h2 id="目录与文件"><a href="#目录与文件" class="headerlink" title="目录与文件"></a><a id="3">目录与文件</a></h2><ul>
<li>目录使用小写加下划线；</li>
<li>类库、函数文件统一以 <code>.php</code> 为后缀；</li>
<li>类的文件名均以命名空间定义，并且命名空间的路径和类库文件所在路径一致；</li>
<li>类文件采用驼峰法命名（首字母大写），其它文件采用小写+下划线命名；</li>
<li>类名和类文件名保持一致，统一采用首字母大写的驼峰法命名；</li>
</ul>
<h2 id="函数、成员属性、成员方法"><a href="#函数、成员属性、成员方法" class="headerlink" title="函数、成员属性、成员方法"></a><a id="4">函数、成员属性、成员方法</a></h2><ul>
<li>函数的命名使用小写字母和下划线的方式</li>
<li>成员属性的命名使用首字母小写的驼峰法</li>
<li>成员方法的命名使用首字母小写的驼峰法</li>
</ul>
<h2 id="数据表和字段"><a href="#数据表和字段" class="headerlink" title="数据表和字段"></a><a id="5">数据表和字段</a></h2><ul>
<li>数据表采用小写加下划线方式命名</li>
<li>字段采用首字母小写的驼峰法命名</li>
</ul>
<h2 id="常量和配置"><a href="#常量和配置" class="headerlink" title="常量和配置"></a><a id="6">常量和配置</a></h2><ul>
<li>常量以大写字母和下划线命名</li>
<li>配置以小写字母和下划线命名</li>
</ul>
<h2 id="示例代码"><a href="#示例代码" class="headerlink" title="示例代码"></a><a id="7">示例代码</a></h2><p>函数声明示例如下：<br><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"><span class="comment">/**</span></div><div class="line"> * 符合 RSR-1,RSR-2 的编程实例</div><div class="line"> *</div><div class="line"> * <span class="doctag">@Date</span>      2017/02/17 18:00</div><div class="line"> * <span class="doctag">@Author</span>    七月十五九月初七</div><div class="line"> * <span class="doctag">@License</span>   广东七月十五九月初七科技有限公司</div><div class="line"> * <span class="doctag">@Copyright</span> Copyright (c) 2017 PSR-1.PSR-2 Ltd</div><div class="line"> */</div><div class="line"><span class="keyword">namespace</span> <span class="title">PSR</span>; <span class="comment">// 顶部命名空间</span></div><div class="line"></div><div class="line"><span class="keyword">use</span> <span class="title">Yii</span>; <span class="comment">// 空一行 use 引入类</span></div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> * 类描述</div><div class="line"> * 类名必须大写开头驼峰.</div><div class="line"> */</div><div class="line"><span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">ExampleClass</span> // </span>&#123;&#125;必须换行</div><div class="line">&#123;</div><div class="line">    <span class="comment">/**</span></div><div class="line">     * 常量描述</div><div class="line">     *</div><div class="line">     * <span class="doctag">@var</span> string</div><div class="line">     */</div><div class="line">    <span class="keyword">const</span> THIS_IS_A_CONST = <span class="string">''</span>; <span class="comment">// 常量全部大写下划线分割</span></div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * 属性描述</div><div class="line">     *</div><div class="line">     * <span class="doctag">@var</span> string</div><div class="line">     */</div><div class="line">    <span class="keyword">public</span> $nameTest = <span class="string">''</span>; <span class="comment">// 属性名称建议开头小写驼峰,成员属性必须添加public（不能省略）， private, protected修饰符</span></div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * 属性描述</div><div class="line">     *</div><div class="line">     * <span class="doctag">@var</span> string</div><div class="line">     */</div><div class="line">    <span class="keyword">private</span> $_privateNameTest = <span class="string">''</span>; <span class="comment">// 类私有成员属性，【个人建议】下划线小写开头驼峰</span></div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * 构造函数</div><div class="line">     *</div><div class="line">     * 构造函数描述</div><div class="line">     *</div><div class="line">     * <span class="doctag">@param</span>  string $value 形参名称/描述</div><div class="line">     */</div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">($value = <span class="string">''</span>)</span>// 成员方法必须添加<span class="title">public</span>（不能省略）， <span class="title">private</span>, <span class="title">protected</span>修饰符</span></div><div class="line">    &#123;<span class="comment">// &#123;&#125;必须换行</span></div><div class="line">        <span class="keyword">$this</span>-&gt;nameTest = <span class="keyword">new</span> TestClass();</div><div class="line">        <span class="comment">// 链式操作</span></div><div class="line">        <span class="keyword">$this</span>-&gt;nameTest-&gt;functionOne()-&gt;functionTwo()-&gt;functionThree();</div><div class="line">        <span class="comment">// 一段代码逻辑执行完毕 换行</span></div><div class="line">        <span class="comment">// code...</span></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * 成员方法名称</div><div class="line">     *</div><div class="line">     * 成员方法描述</div><div class="line">     *</div><div class="line">     * <span class="doctag">@param</span>  string $value 形参名称/描述</div><div class="line">     *</div><div class="line">     * <span class="doctag">@return</span> 返回值类型 返回值描述</div><div class="line">     */</div><div class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="function"><span class="keyword">function</span> <span class="title">staticFunction</span><span class="params">($value = <span class="string">''</span>)</span>// <span class="title">static</span>位于修饰符之后</span></div><div class="line">    &#123;</div><div class="line">        <span class="comment">// code...</span></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * 成员方法名称</div><div class="line">     *</div><div class="line">     * 成员方法描述</div><div class="line">     *</div><div class="line">     * <span class="doctag">@param</span>  string $value 形参名称/描述</div><div class="line">     *</div><div class="line">     * <span class="doctag">@return</span> 返回值类型 返回值描述</div><div class="line">     * 返回值类型：string，array，object，mixed（多种，不确定的），void（无返回值）</div><div class="line">     */</div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">testFunction</span><span class="params">($value = <span class="string">''</span>)</span>// 成员方法必须小写开头驼峰</span></div><div class="line">    &#123;</div><div class="line">        <span class="comment">// code...</span></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * 成员方法名称</div><div class="line">     *</div><div class="line">     * 成员方法描述</div><div class="line">     *</div><div class="line">     * <span class="doctag">@param</span>  string $value 形参名称/描述</div><div class="line">     *</div><div class="line">     * <span class="doctag">@return</span> 返回值类型 返回值描述</div><div class="line">     */</div><div class="line">    <span class="keyword">abstract</span> <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">abstractFunction</span><span class="params">($value = <span class="string">''</span>)</span></span>;</div><div class="line">    <span class="comment">// abstract 位于修饰符之前</span></div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * 成员方法名称.</div><div class="line">     * 成员方法描述</div><div class="line">     *</div><div class="line">     * <span class="doctag">@param</span>  string $value 形参名称/描述</div><div class="line">     *</div><div class="line">     * <span class="doctag">@return</span> 返回值类型 返回值描述</div><div class="line">     */</div><div class="line">    <span class="keyword">final</span> <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">finalFunction</span><span class="params">($value = <span class="string">''</span>)</span>// <span class="title">final</span> 位于修饰符之前</span></div><div class="line">    &#123;</div><div class="line">        <span class="comment">// code...</span></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * 成员方法名称</div><div class="line">     *</div><div class="line">     * 成员方法描述</div><div class="line">     *</div><div class="line">     * <span class="doctag">@param</span>  string $paramOne   形参名称/描述</div><div class="line">     * <span class="doctag">@param</span>  string $paramTwo   形参名称/描述</div><div class="line">     * <span class="doctag">@param</span>  string $paramThree 形参名称/描述</div><div class="line">     * <span class="doctag">@param</span>  string $paramFour  形参名称/描述</div><div class="line">     * <span class="doctag">@param</span>  string $paramFive  形参名称/描述</div><div class="line">     * <span class="doctag">@param</span>  string $paramSix   形参名称/描述</div><div class="line">     *</div><div class="line">     * <span class="doctag">@return</span> 返回值类型 返回值描述</div><div class="line">     */</div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">tooLangFunction</span><span class="params">(</span></span></div><div class="line">        $paramOne = <span class="string">''</span>, // 变量命名可小写开头驼峰或者下划线命名</div><div class="line">        $paramTwo = <span class="string">''</span>,</div><div class="line">        $paramThree = <span class="string">''</span>,</div><div class="line">        $paramFour = <span class="string">''</span>,</div><div class="line">        $paramFive = <span class="string">''</span>,</div><div class="line">        $paramSix = <span class="string">''</span></div><div class="line">    )// 参数过多换行</div><div class="line">    &#123;</div><div class="line">        <span class="keyword">if</span> ($paramOne === $paramTwo) &#123;<span class="comment">// 控制结构=&gt;后加空格,同&#123;一行，（右边和)左边不加空格</span></div><div class="line">            <span class="comment">// code...</span></div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="keyword">if</span> ($paramTwo === $paramThree) &#123;</div><div class="line"></div><div class="line">        &#125; <span class="keyword">elseif</span> ($paramFour === $paramFive) &#123;</div><div class="line"></div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line"></div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="keyword">switch</span> ($paramThree) &#123;</div><div class="line">            <span class="keyword">case</span> <span class="string">'three'</span>:</div><div class="line">                <span class="comment">// code...</span></div><div class="line">                <span class="keyword">break</span>;</div><div class="line">            <span class="keyword">case</span> <span class="string">'one'</span>:</div><div class="line">            <span class="keyword">case</span> <span class="string">'two'</span>:</div><div class="line">            <span class="keyword">case</span> <span class="string">'four'</span>:</div><div class="line">            <span class="keyword">case</span> <span class="string">'five'</span>:</div><div class="line">                <span class="comment">// code...</span></div><div class="line">                <span class="keyword">break</span>;</div><div class="line">            <span class="keyword">default</span>:</div><div class="line">                <span class="comment">// code...</span></div><div class="line">                <span class="keyword">break</span>;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="keyword">do</span> &#123;</div><div class="line">            <span class="comment">// code...</span></div><div class="line">        &#125; <span class="keyword">while</span> ($paramFour &lt;= <span class="number">10</span>);</div><div class="line"></div><div class="line">        <span class="keyword">while</span> ($paramFive &lt;= <span class="number">10</span>) &#123;</div><div class="line">            <span class="comment">// code...</span></div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="keyword">for</span> ($i = <span class="number">0</span>; $i &lt; $paramSix; $i++) &#123;</div><div class="line">            <span class="comment">// code...</span></div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/**</span></div><div class="line">     * 成员方法名称</div><div class="line">     *</div><div class="line">     * 成员方法描述</div><div class="line">     *</div><div class="line">     * <span class="doctag">@param</span>  string $value 形参名称/描述</div><div class="line">     *</div><div class="line">     * <span class="doctag">@return</span> 返回值类型 返回值描述</div><div class="line">     */</div><div class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">_privateTestFunction</span><span class="params">($value = <span class="string">''</span>)</span>// 私有成员方法【个人建议】下划线小写开头驼峰</span></div><div class="line">    &#123;</div><div class="line">        <span class="comment">// code...</span></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h2 id="参考链接"><a href="#参考链接" class="headerlink" title="参考链接"></a><a id="8">参考链接</a></h2><ul>
<li><a href="https://github.com/TIGERB/easy-tips" target="_blank" rel="external">PHP Easy Tips</a></li>
<li><a href="http://www.kancloud.cn/thinkphp/thinkphp5-guide/90124" target="_blank" rel="external">ThinkPHP 5 命名规范</a></li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://luisedware.github.io/2017/02/11/LuisEdware-版-PHP-编程规范（遵循-PSR-1-PSR-2）/" data-id="cj3gyqvae0018xo4bclxg6mwo" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/PHP/">PHP</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-PHP-Codebook-九" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/01/24/PHP-Codebook-九/" class="article-date">
  <time datetime="2017-01-24T03:15:01.000Z" itemprop="datePublished">2017-01-24</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/PHP/">PHP</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/01/24/PHP-Codebook-九/">PHP Codebook(九)</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="9-1-处理表单输入"><a href="#9-1-处理表单输入" class="headerlink" title="9.1 处理表单输入"></a>9.1 处理表单输入</h2><h4 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h4><p>希望使用一个 HTML 页面提交表单，然后在同一个页面中处理这个表单中输入的数据</p>
<h4 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h4><p>使用 $_SERVER[‘REQUEST_METHOD’] 变量来确定请求是用 get 还是 post 方法提交的。</p>
<h2 id="9-2-验证表单输入：必填域"><a href="#9-2-验证表单输入：必填域" class="headerlink" title="9.2 验证表单输入：必填域"></a>9.2 验证表单输入：必填域</h2><h4 id="问题-1"><a href="#问题-1" class="headerlink" title="问题"></a>问题</h4><p>希望确保必须为一个表单元素提供一个值。例如，希望保证一个文本框不为空</p>
<h4 id="实现-1"><a href="#实现-1" class="headerlink" title="实现"></a>实现</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"><span class="keyword">if</span> (!(filter_has_var(INPUT_GET, <span class="string">'flavor'</span>)</div><div class="line">    &amp;&amp; (strlen(filter_input(INPUT_GET, <span class="string">'flavor'</span>))))</div><div class="line">) &#123;</div><div class="line">    <span class="keyword">print</span> <span class="string">"You must enter your favorite ice cream flavor.\n"</span>;</div><div class="line">&#125; <span class="keyword">else</span> &#123;</div><div class="line">    <span class="keyword">echo</span> $_GET[<span class="string">'flavor'</span>];</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">if</span> ((filter_has_var(INPUT_GET, <span class="string">'color'</span>))</div><div class="line">    &amp;&amp; (strlen(filter_input(INPUT_GET, <span class="string">'color'</span>, FILTER_SANITIZE_STRING)) &lt;= <span class="number">5</span>)</div><div class="line">) &#123;</div><div class="line">    <span class="keyword">print</span> <span class="string">"Color must be more than 5 characters."</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">if</span> (!(filter_has_var(INPUT_GET, <span class="string">'choices'</span>))</div><div class="line">    &amp;&amp; filter_input(INPUT_GET, <span class="string">'choices'</span>, FILTER_DEFAULT, FILTER_REQUIRE_ARRAY)</div><div class="line">) &#123;</div><div class="line">    <span class="keyword">print</span> <span class="string">"You must select some choices.\n"</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure>
<h2 id="9-3-验证表单输入：数字"><a href="#9-3-验证表单输入：数字" class="headerlink" title="9.3 验证表单输入：数字"></a>9.3 验证表单输入：数字</h2><h4 id="问题-2"><a href="#问题-2" class="headerlink" title="问题"></a>问题</h4><p>希望确保在一个表单输入框中输入了一个数。</p>
<h4 id="实现-2"><a href="#实现-2" class="headerlink" title="实现"></a>实现</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line">$age = filter_input(INPUT_GET, <span class="string">'age'</span>, FILTER_VALIDATE_INT);</div><div class="line"><span class="keyword">if</span> ($age === <span class="keyword">false</span>) &#123;</div><div class="line">    <span class="keyword">print</span> <span class="string">"Submitted age is invalid."</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line">$price = filter_input(INPUT_GET, <span class="string">'price'</span>, FILTER_VALIDATE_FLOAT);</div><div class="line"><span class="keyword">if</span> ($price === <span class="keyword">false</span>) &#123;</div><div class="line">    <span class="keyword">print</span> <span class="string">"Submitted price is invalid."</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="9-4-验证表单输入：email-地址"><a href="#9-4-验证表单输入：email-地址" class="headerlink" title="9.4 验证表单输入：email 地址"></a>9.4 验证表单输入：email 地址</h2><h4 id="问题-3"><a href="#问题-3" class="headerlink" title="问题"></a>问题</h4><p>希望知道用户提供的一个 email 地址是否合法</p>
<h4 id="实现-3"><a href="#实现-3" class="headerlink" title="实现"></a>实现</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line">$email = filter_input(INPUT_GET, <span class="string">'email'</span>, FILTER_VALIDATE_EMAIL);</div><div class="line"><span class="keyword">if</span> ($email === <span class="keyword">false</span>) &#123;</div><div class="line">    <span class="keyword">print</span> <span class="string">"Submitted email is invalid."</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="9-16-处理变量名中包含点号的远程变量"><a href="#9-16-处理变量名中包含点号的远程变量" class="headerlink" title="9.16 处理变量名中包含点号的远程变量"></a>9.16 处理变量名中包含点号的远程变量</h2><h4 id="问题-4"><a href="#问题-4" class="headerlink" title="问题"></a>问题</h4><p>希望处理一个变量，变量名中有一个点号，不过提交表单时，无法在 $_GET 或者 $_POST 中找到这个变量。</p>
<h4 id="实现-4"><a href="#实现-4" class="headerlink" title="实现"></a>实现</h4><p>将变量名中的点号替换为一个下划线。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://luisedware.github.io/2017/01/24/PHP-Codebook-九/" data-id="cj3gyqvay001wxo4bo8p8ury4" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/PHP/">PHP</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-PHP-Codebook-六" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/01/24/PHP-Codebook-六/" class="article-date">
  <time datetime="2017-01-24T00:34:59.000Z" itemprop="datePublished">2017-01-24</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/PHP/">PHP</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/01/24/PHP-Codebook-六/">PHP Codebook(六)</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="6-4-使用命名参数"><a href="#6-4-使用命名参数" class="headerlink" title="6.4 使用命名参数"></a>6.4 使用命名参数</h2><h4 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h4><p>希望按名为函数指定参数，而不是通过函数调用时的位置来指定。</p>
<h4 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">image1</span><span class="params">($params)</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">if</span> (!<span class="keyword">isset</span>($params[<span class="string">'src'</span>])) &#123;</div><div class="line">        $image[<span class="string">'src'</span>] = <span class="string">'cow.png'</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">if</span> (!<span class="keyword">isset</span>($params[<span class="string">'alt'</span>])) &#123;</div><div class="line">        $image[<span class="string">'alt'</span>] = <span class="string">'Milk Factory'</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">if</span> (!<span class="keyword">isset</span>($params[<span class="string">'height'</span>])) &#123;</div><div class="line">        $image[<span class="string">'height'</span>] = <span class="string">'100'</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">if</span> (!<span class="keyword">isset</span>($params[<span class="string">'width'</span>])) &#123;</div><div class="line">        $image[<span class="string">'width'</span>] = <span class="string">'50'</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">return</span> <span class="string">'&lt;img src="'</span> . $image[<span class="string">'src'</span>] . <span class="string">'" alt="'</span> . $image[<span class="string">'alt'</span>] . <span class="string">'" width="'</span> . $image[<span class="string">'width'</span>] . <span class="string">'" height="'</span> . $image[<span class="string">'height'</span>] . <span class="string">'"&gt;'</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">image2</span><span class="params">($params)</span></span></div><div class="line">&#123;</div><div class="line">    $defaults = [</div><div class="line">        <span class="string">'src'</span> =&gt; <span class="string">'cow.png'</span>,</div><div class="line">        <span class="string">'alt'</span> =&gt; <span class="string">'milk factory'</span>,</div><div class="line">        <span class="string">'width'</span> =&gt; <span class="number">100</span>,</div><div class="line">        <span class="string">'height'</span> =&gt; <span class="number">50</span>,</div><div class="line">    ];</div><div class="line"></div><div class="line">    $params = array_merge($defaults, $params);</div><div class="line">    <span class="keyword">return</span> <span class="string">'&lt;img src="'</span> . $image[<span class="string">'src'</span>] . <span class="string">'" alt="'</span> . $image[<span class="string">'alt'</span>] . <span class="string">'" width="'</span> . $image[<span class="string">'width'</span>] . <span class="string">'" height="'</span> . $image[<span class="string">'height'</span>] . <span class="string">'"&gt;'</span>;</div><div class="line">&#125;</div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure>
<h2 id="6-6-创建参数个数可变的函数"><a href="#6-6-创建参数个数可变的函数" class="headerlink" title="6.6 创建参数个数可变的函数"></a>6.6 创建参数个数可变的函数</h2><h4 id="问题-1"><a href="#问题-1" class="headerlink" title="问题"></a>问题</h4><p>希望定义一个参数个数可变的函数</p>
<h4 id="实现-1"><a href="#实现-1" class="headerlink" title="实现"></a>实现</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">mean</span><span class="params">($numbers)</span></span></div><div class="line">&#123;</div><div class="line">    $sum = <span class="number">0</span>;</div><div class="line"></div><div class="line">    $size = count($numbers);</div><div class="line"></div><div class="line">    <span class="keyword">for</span> ($i = <span class="number">0</span>; $i &lt; $size; $i++) &#123;</div><div class="line">        $sum += $numbers[$i];</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    $average = $sum / $size;</div><div class="line"></div><div class="line">    <span class="keyword">return</span> $average;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">echo</span> mean([<span class="number">96</span>, <span class="number">93</span>, <span class="number">98</span>, <span class="number">98</span>]) . <span class="string">"\n"</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">mean1</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">    $sum = <span class="number">0</span>;</div><div class="line"></div><div class="line">    $size = func_num_args();</div><div class="line"></div><div class="line">    <span class="keyword">for</span> ($i = <span class="number">0</span>; $i &lt; $size; $i++) &#123;</div><div class="line">        $sum += func_get_arg($i);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    $average = $sum / $size;</div><div class="line"></div><div class="line">    <span class="keyword">return</span> $average;</div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">echo</span> mean1(<span class="number">96</span>, <span class="number">93</span>, <span class="number">98</span>, <span class="number">98</span>) . <span class="string">"\n"</span>;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">mean2</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">    $sum = <span class="number">0</span>;</div><div class="line"></div><div class="line">    $size = func_num_args();</div><div class="line"></div><div class="line">    <span class="keyword">foreach</span> (func_get_args() <span class="keyword">as</span> $arg) &#123;</div><div class="line">        $sum += $arg;</div><div class="line">    &#125;</div><div class="line">    $average = $sum / $size;</div><div class="line"></div><div class="line">    <span class="keyword">return</span> $average;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">echo</span> mean2(<span class="number">96</span>, <span class="number">93</span>, <span class="number">98</span>, <span class="number">98</span>) . <span class="string">"\n"</span>;</div></pre></td></tr></table></figure>
<h2 id="6-7-按引用返回值"><a href="#6-7-按引用返回值" class="headerlink" title="6.7 按引用返回值"></a>6.7 按引用返回值</h2><h4 id="问题-2"><a href="#问题-2" class="headerlink" title="问题"></a>问题</h4><p>希望按引用返回一个值，而不是按值返回。这样就无需为变量建立一个重复的副本。</p>
<h4 id="实现-2"><a href="#实现-2" class="headerlink" title="实现"></a>实现</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> &amp;<span class="title">array_find_value</span><span class="params">($needle, &amp;$haystack)</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">foreach</span> ($haystack <span class="keyword">as</span> $key =&gt; $value) &#123;</div><div class="line">        <span class="keyword">if</span> ($needle == $value) &#123;</div><div class="line">            <span class="keyword">return</span> $haystack[$key];</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">$names = [<span class="string">'Ann Eason'</span>, <span class="string">'Luis Edware'</span>, <span class="string">'Ivan Tomic'</span>, <span class="string">'RouniFul'</span>];</div><div class="line"></div><div class="line">$prince =&amp; array_find_value(<span class="string">'Ann Eason'</span>, $names);</div><div class="line">$prince = <span class="string">"梁非凡"</span>;</div><div class="line">print_r($names);</div></pre></td></tr></table></figure>
<h2 id="6-8-返回多个值"><a href="#6-8-返回多个值" class="headerlink" title="6.8 返回多个值"></a>6.8 返回多个值</h2><h4 id="问题-3"><a href="#问题-3" class="headerlink" title="问题"></a>问题</h4><p>希望从函数返回多个值。</p>
<h4 id="实现-3"><a href="#实现-3" class="headerlink" title="实现"></a>实现</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">array_stats</span><span class="params">($values)</span></span></div><div class="line">&#123;</div><div class="line">    $min = min($values);</div><div class="line">    $max = max($values);</div><div class="line">    $mean = array_sum($values) / count($values);</div><div class="line"></div><div class="line">    <span class="keyword">return</span> [$min, $max, $mean];</div><div class="line">&#125;</div><div class="line"></div><div class="line">$values = range(<span class="number">1</span>, <span class="number">100</span>);</div><div class="line"><span class="keyword">list</span>($min, $max, $mean) = array_stats($values);</div><div class="line"></div><div class="line"><span class="keyword">echo</span> sprintf(<span class="string">"min is %d,max is %d,mean is %d"</span>, $min, $max, $mean);</div></pre></td></tr></table></figure>
<h2 id="6-10-返回失败"><a href="#6-10-返回失败" class="headerlink" title="6.10 返回失败"></a>6.10 返回失败</h2><h4 id="问题-4"><a href="#问题-4" class="headerlink" title="问题"></a>问题</h4><p>希望从函数中指示失败</p>
<h4 id="实现-4"><a href="#实现-4" class="headerlink" title="实现"></a>实现</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">lookup</span><span class="params">($name)</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">if</span> (<span class="keyword">empty</span>($name)) &#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">$name = <span class="keyword">false</span>;</div><div class="line"><span class="keyword">if</span> (<span class="keyword">false</span> !== lookup($name)) &#123;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="6-11-调用可变函数"><a href="#6-11-调用可变函数" class="headerlink" title="6.11  调用可变函数"></a>6.11  调用可变函数</h2><h4 id="问题-5"><a href="#问题-5" class="headerlink" title="问题"></a>问题</h4><p>希望根据一个变量的值来调用不同的函数</p>
<h4 id="实现-5"><a href="#实现-5" class="headerlink" title="实现"></a>实现</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">get_file</span><span class="params">($fileName)</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">return</span> file_get_contents($fileName);</div><div class="line">&#125;</div><div class="line"></div><div class="line">$function = <span class="string">'get_file'</span>;</div><div class="line">$fileName = <span class="string">'graphic.png'</span>;</div><div class="line"></div><div class="line">call_user_func($function, $fileName);</div></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://luisedware.github.io/2017/01/24/PHP-Codebook-六/" data-id="cj3gyqvb0001zxo4bpzpfu0xi" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/PHP/">PHP</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-PHP-Codebook-四" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/01/22/PHP-Codebook-四/" class="article-date">
  <time datetime="2017-01-22T06:56:46.000Z" itemprop="datePublished">2017-01-22</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/PHP/">PHP</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/01/22/PHP-Codebook-四/">PHP Codebook(四)</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="4-1-指定并非从元素-0-开始的数组"><a href="#4-1-指定并非从元素-0-开始的数组" class="headerlink" title="4.1 指定并非从元素 0 开始的数组"></a>4.1 指定并非从元素 0 开始的数组</h2><h4 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h4><p>希望一步为一个数组赋多个元素，不过不希望第一个元素的索引为0</p>
<h4 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"></div><div class="line">$presidents = [<span class="number">1</span> =&gt; <span class="string">'Washington'</span>, <span class="string">'Adams'</span>, <span class="string">'Lincoln'</span>, <span class="string">'Jefferson'</span>];</div><div class="line">var_dump($presidents);</div><div class="line"></div><div class="line">$fruits[<span class="number">1</span>] = <span class="string">'apple'</span>;</div><div class="line">$fruits[] = <span class="string">'banana'</span>;</div><div class="line">var_dump($fruits);</div></pre></td></tr></table></figure>
<h2 id="4-3-数组初始化为一个整数范围"><a href="#4-3-数组初始化为一个整数范围" class="headerlink" title="4.3 数组初始化为一个整数范围"></a>4.3 数组初始化为一个整数范围</h2><h4 id="问题-1"><a href="#问题-1" class="headerlink" title="问题"></a>问题</h4><p>希望将一系列连续的整数赋至一个数组</p>
<h4 id="实现-1"><a href="#实现-1" class="headerlink" title="实现"></a>实现</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line">$cards = range(<span class="number">1</span>,<span class="number">52</span>);</div></pre></td></tr></table></figure>
<h2 id="4-4-迭代处理数组"><a href="#4-4-迭代处理数组" class="headerlink" title="4.4 迭代处理数组"></a>4.4 迭代处理数组</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line">$array = range(<span class="number">0</span>, <span class="number">12</span>);</div><div class="line"></div><div class="line"><span class="keyword">foreach</span> ($array <span class="keyword">as</span> $item) &#123;</div><div class="line">    <span class="keyword">echo</span> $item . <span class="string">"\n"</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">foreach</span> ($array <span class="keyword">as</span> $key =&gt; $value) &#123;</div><div class="line">    <span class="keyword">echo</span> $value . <span class="string">"\n"</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">for</span> ($key = <span class="number">0</span>, $size = count($array); $key &lt; $size; $key++) &#123;</div><div class="line">    <span class="keyword">echo</span> $array[$key] . <span class="string">"\n"</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// 将内部指针重置为数组起始位置</span></div><div class="line">reset($array);</div><div class="line"><span class="keyword">while</span> (<span class="keyword">list</span>($key, $value) = each($array)) &#123;</div><div class="line">    <span class="keyword">echo</span> $value . <span class="string">"\n"</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line">array_map(<span class="function"><span class="keyword">function</span><span class="params">($value)</span> </span>&#123;</div><div class="line">    <span class="keyword">return</span> $value;</div><div class="line">&#125;, $array);</div></pre></td></tr></table></figure>
<h2 id="4-5-从数组删除元素"><a href="#4-5-从数组删除元素" class="headerlink" title="4.5 从数组删除元素"></a>4.5 从数组删除元素</h2><h4 id="问题-2"><a href="#问题-2" class="headerlink" title="问题"></a>问题</h4><p>希望从一个数组删除一个或多个数组</p>
<h4 id="实现-2"><a href="#实现-2" class="headerlink" title="实现"></a>实现</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line">$array = range(<span class="number">0</span>, <span class="number">12</span>);</div><div class="line"></div><div class="line"><span class="comment">// 删除元素</span></div><div class="line"><span class="keyword">unset</span>($array[<span class="number">0</span>]);</div><div class="line"></div><div class="line"><span class="comment">// 删除多个连续的元素,array_splice 会自动对数组重新建立索引，避免留出空位。</span></div><div class="line">array_splice($array, <span class="number">1</span>, <span class="number">9</span>);</div><div class="line">var_dump($array);</div></pre></td></tr></table></figure>
<h2 id="4-6-改变数组大小"><a href="#4-6-改变数组大小" class="headerlink" title="4.6 改变数组大小"></a>4.6 改变数组大小</h2><h4 id="问题-3"><a href="#问题-3" class="headerlink" title="问题"></a>问题</h4><p>希望改变一个数组的大小，使它大于或小于目前的大小</p>
<h4 id="实现-3"><a href="#实现-3" class="headerlink" title="实现"></a>实现</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"></div><div class="line"><span class="comment">// array_pad() 第一个</span></div><div class="line">$array = [<span class="string">'apple'</span>, <span class="string">'banana'</span>, <span class="string">'cocount'</span>];</div><div class="line">$array = array_pad($array, <span class="number">4</span>, <span class="string">'dates'</span>);</div><div class="line">print_r($array);</div><div class="line"></div><div class="line">$array = array_pad($array, <span class="number">-10</span>, <span class="string">'zucchini'</span>);</div><div class="line">print_r($array);</div></pre></td></tr></table></figure>
<h2 id="4-7-将数组追加到另一个数组"><a href="#4-7-将数组追加到另一个数组" class="headerlink" title="4.7 将数组追加到另一个数组"></a>4.7 将数组追加到另一个数组</h2><h4 id="问题-4"><a href="#问题-4" class="headerlink" title="问题"></a>问题</h4><p>希望把两个数组合并为一个数组</p>
<h4 id="实现-4"><a href="#实现-4" class="headerlink" title="实现"></a>实现</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"><span class="comment">// 合并只使用数值键的数组时，数组将重新编号，以保证值不会丢失。</span></div><div class="line">$array1 = [<span class="string">'hello'</span>, <span class="string">'world'</span>];</div><div class="line">$array2 = [<span class="string">'luis'</span>, <span class="string">'edware'</span>, <span class="string">'hello'</span>, <span class="string">'world'</span>];</div><div class="line">$array3 = array_merge($array1, $array2);</div><div class="line">print_r($array3);</div><div class="line"></div><div class="line"><span class="comment">// + 操作符也可以用来合并数组</span></div><div class="line">print_r($array1 + $array2);</div><div class="line"></div><div class="line"><span class="comment">// 倘若两个数组有重复的键，第二数组会覆盖这些重复键的值</span></div><div class="line">$array1 = [<span class="string">'A'</span> =&gt; <span class="string">'apple'</span>, <span class="string">'B'</span> =&gt; <span class="string">'banana'</span>, <span class="string">'O'</span> =&gt; <span class="string">'orange'</span>];</div><div class="line">$array2 = [<span class="string">'A'</span> =&gt; <span class="string">'Luis'</span>, <span class="string">'C'</span> =&gt; <span class="string">'Imooc'</span>];</div><div class="line">print_r(array_merge($array1, $array2));</div></pre></td></tr></table></figure>
<h2 id="4-8-将数组转换为字符串"><a href="#4-8-将数组转换为字符串" class="headerlink" title="4.8 将数组转换为字符串"></a>4.8 将数组转换为字符串</h2><h4 id="问题-5"><a href="#问题-5" class="headerlink" title="问题"></a>问题</h4><p>希望将一个数组转换为一个格式化的字符串</p>
<h4 id="实现-5"><a href="#实现-5" class="headerlink" title="实现"></a>实现</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line">$array = range(<span class="number">0</span>, <span class="number">9</span>);</div><div class="line">$string1 = join(<span class="string">','</span>, $array);</div><div class="line">$string2 = implode(<span class="string">','</span>, $array);</div><div class="line">print_r($string1 . <span class="string">"\n"</span>);</div><div class="line">print_r($string2 . <span class="string">"\n"</span>);</div></pre></td></tr></table></figure>
<h2 id="4-10-检查一个键是否存在数组中"><a href="#4-10-检查一个键是否存在数组中" class="headerlink" title="4.10 检查一个键是否存在数组中"></a>4.10 检查一个键是否存在数组中</h2><h4 id="问题-6"><a href="#问题-6" class="headerlink" title="问题"></a>问题</h4><p>想知道一个数组是否包含某个键</p>
<h4 id="实现-6"><a href="#实现-6" class="headerlink" title="实现"></a>实现</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"></div><div class="line">$array = [<span class="string">'a'</span> =&gt; <span class="string">'apple'</span>, <span class="string">'b'</span> =&gt; <span class="string">'banana'</span>, <span class="string">'c'</span> =&gt; <span class="string">'cao ni ma'</span>];</div><div class="line"><span class="keyword">if</span> (array_key_exists(<span class="string">'a'</span>, $array)) &#123;</div><div class="line">    <span class="keyword">echo</span> $array[<span class="string">'a'</span>] . <span class="string">"\n"</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($array[<span class="string">'a'</span>])) &#123;</div><div class="line">    <span class="keyword">echo</span> $array[<span class="string">'c'</span>] . <span class="string">"\n"</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="4-11-检查一个元素是否在数组中"><a href="#4-11-检查一个元素是否在数组中" class="headerlink" title="4.11 检查一个元素是否在数组中"></a>4.11 检查一个元素是否在数组中</h2><h4 id="问题-7"><a href="#问题-7" class="headerlink" title="问题"></a>问题</h4><p>希望知道一个数组是否包含某个值</p>
<h4 id="实现-7"><a href="#实现-7" class="headerlink" title="实现"></a>实现</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"></div><div class="line">$array = [<span class="string">'a'</span> =&gt; <span class="string">'apple'</span>, <span class="string">'b'</span> =&gt; <span class="string">'banana'</span>, <span class="string">'c'</span> =&gt; <span class="string">'cao ni ma'</span>];</div><div class="line"></div><div class="line"><span class="keyword">if</span> (in_array(<span class="string">'apple'</span>, $array)) &#123;</div><div class="line">    <span class="keyword">echo</span> <span class="string">'Own it'</span>;</div><div class="line">&#125; <span class="keyword">else</span> &#123;</div><div class="line">    <span class="keyword">echo</span> <span class="string">'Need it'</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line">$array = [<span class="string">'Emma'</span>, <span class="string">'Pride and Prejudice'</span>, <span class="string">'Northhanger Abbey'</span>];</div><div class="line">$array = array_flip($array);</div><div class="line"><span class="keyword">if</span> (array_key_exists(<span class="string">'Emma'</span>, $array)) &#123;</div><div class="line">    <span class="keyword">echo</span> <span class="string">'Own it'</span>;</div><div class="line">&#125; <span class="keyword">else</span> &#123;</div><div class="line">    <span class="keyword">echo</span> <span class="string">'Need it'</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="4-12-查找一个值在数组中的位置"><a href="#4-12-查找一个值在数组中的位置" class="headerlink" title="4.12 查找一个值在数组中的位置"></a>4.12 查找一个值在数组中的位置</h2><h4 id="问题-8"><a href="#问题-8" class="headerlink" title="问题"></a>问题</h4><p>希望知道一个值是否在数组中。如果这个值确实在数组中，希望知道它的键。</p>
<h4 id="实现-8"><a href="#实现-8" class="headerlink" title="实现"></a>实现</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"></div><div class="line"><span class="comment">// 如果一个值在数组中多次出现，array_serach() 只能保证返回其中一个实例，而不一定是第一个实例。</span></div><div class="line">$position = [<span class="string">'a'</span>=&gt;<span class="string">'apple'</span>,<span class="string">'banana'</span>,<span class="string">'orange'</span>,<span class="string">'b'</span>=&gt;<span class="string">'not bad'</span>];</div><div class="line"><span class="keyword">if</span>(($result = array_search(<span class="string">'123'</span>, $position)) !== <span class="keyword">false</span>)&#123;</div><div class="line">    <span class="keyword">echo</span> $result;</div><div class="line">&#125;<span class="keyword">else</span>&#123;</div><div class="line">    <span class="keyword">echo</span> <span class="string">'false'</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="4-13-查找通过某个测试的元素"><a href="#4-13-查找通过某个测试的元素" class="headerlink" title="4.13 查找通过某个测试的元素"></a>4.13 查找通过某个测试的元素</h2><h4 id="问题-9"><a href="#问题-9" class="headerlink" title="问题"></a>问题</h4><p>希望找出数组中满足某些需求的元素</p>
<h4 id="实现-9"><a href="#实现-9" class="headerlink" title="实现"></a>实现</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line">    $array = range(<span class="number">0</span>, <span class="number">20</span>,<span class="number">2</span>);</div><div class="line"></div><div class="line">    $result = array_filter($array,<span class="function"><span class="keyword">function</span><span class="params">($value)</span></span>&#123;</div><div class="line">        <span class="keyword">if</span>($value%<span class="number">2</span> === <span class="number">0</span>)&#123;</div><div class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">        &#125;<span class="keyword">else</span> &#123;</div><div class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;);</div><div class="line"><span class="meta">?&gt;</span></div></pre></td></tr></table></figure>
<h2 id="4-14-查找数组中最大值或最小值元素"><a href="#4-14-查找数组中最大值或最小值元素" class="headerlink" title="4.14 查找数组中最大值或最小值元素"></a>4.14 查找数组中最大值或最小值元素</h2><h4 id="问题-10"><a href="#问题-10" class="headerlink" title="问题"></a>问题</h4><p>希望找出数组中有最大值或最小值的元素。</p>
<h4 id="实现-10"><a href="#实现-10" class="headerlink" title="实现"></a>实现</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line">$array = range(<span class="number">1</span>, <span class="number">100</span>);</div><div class="line"></div><div class="line"><span class="keyword">echo</span> max($array) . <span class="string">"\n"</span>;</div><div class="line"><span class="keyword">echo</span> min($array) . <span class="string">"\n"</span>;</div></pre></td></tr></table></figure>
<h2 id="4-15-反转数组"><a href="#4-15-反转数组" class="headerlink" title="4.15 反转数组"></a>4.15 反转数组</h2><h4 id="问题-11"><a href="#问题-11" class="headerlink" title="问题"></a>问题</h4><p>希望反转数组中元素的顺序</p>
<h4 id="实现-11"><a href="#实现-11" class="headerlink" title="实现"></a>实现</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"></div><div class="line">$array = range(<span class="number">1</span>, <span class="number">100</span>);</div><div class="line">$array = array_reverse($array);</div><div class="line">print_r($array);</div><div class="line"></div><div class="line">$fruits = [<span class="string">'a'</span> =&gt; <span class="string">'Apple'</span>, <span class="string">'b'</span> =&gt; <span class="string">'Banana'</span>, <span class="string">'o'</span> =&gt; <span class="string">'orange'</span>];</div><div class="line">$fruits = array_reverse($fruits);</div><div class="line">print_r($fruits);</div></pre></td></tr></table></figure>
<h2 id="4-18-多个数据的排序"><a href="#4-18-多个数据的排序" class="headerlink" title="4.18 多个数据的排序"></a>4.18 多个数据的排序</h2><h4 id="问题-12"><a href="#问题-12" class="headerlink" title="问题"></a>问题</h4><p>希望对多个数组或多位数组排序</p>
<h4 id="实现-12"><a href="#实现-12" class="headerlink" title="实现"></a>实现</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"></div><div class="line">$colors = [<span class="string">'Red'</span>, <span class="string">'White'</span>, <span class="string">'Blue'</span>];</div><div class="line">$cities = [<span class="string">'Boston'</span>, <span class="string">'New York'</span>, <span class="string">'Chicago'</span>];</div><div class="line">$stuff = [</div><div class="line">    <span class="string">'colors'</span> =&gt; $colors,</div><div class="line">    <span class="string">'cities'</span> =&gt; $cities,</div><div class="line">];</div><div class="line"></div><div class="line">array_multisort($colors, $cities);</div><div class="line">print_r($colors);</div><div class="line">print_r($cities);</div><div class="line"></div><div class="line"></div><div class="line">array_multisort($stuff[<span class="string">'colors'</span>], $stuff[<span class="string">'cities'</span>]);</div><div class="line">print_r($stuff);</div><div class="line"></div><div class="line"></div><div class="line">$numbers = [<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</div><div class="line">$letters = [<span class="string">'a'</span>, <span class="string">'b'</span>, <span class="string">'c'</span>, <span class="string">'d'</span>];</div><div class="line"></div><div class="line">array_multisort($numbers, SORT_NUMERIC, SORT_DESC, $letters, SORT_STRING, SORT_DESC);</div><div class="line">print_r($numbers);</div><div class="line">print_r($letters);</div></pre></td></tr></table></figure>
<h2 id="4-20-随机调整数组"><a href="#4-20-随机调整数组" class="headerlink" title="4.20 随机调整数组"></a>4.20 随机调整数组</h2><h4 id="问题-13"><a href="#问题-13" class="headerlink" title="问题"></a>问题</h4><p>希望按一种随机的顺序重排数组中的元素</p>
<h4 id="实现-13"><a href="#实现-13" class="headerlink" title="实现"></a>实现</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"></div><div class="line">$name = [<span class="string">'Ann'</span>, <span class="string">'Eason'</span>, <span class="string">'Luis'</span>, <span class="string">'Edware'</span>];</div><div class="line">print_r($name);</div><div class="line"></div><div class="line">shuffle($name);</div><div class="line">print_r($name);</div></pre></td></tr></table></figure>
<h2 id="4-21-删除数组中重复的元素"><a href="#4-21-删除数组中重复的元素" class="headerlink" title="4.21 删除数组中重复的元素"></a>4.21 删除数组中重复的元素</h2><h4 id="问题-14"><a href="#问题-14" class="headerlink" title="问题"></a>问题</h4><p>希望删除数组中重复的元素</p>
<h4 id="实现-14"><a href="#实现-14" class="headerlink" title="实现"></a>实现</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"></div><div class="line">$array = [<span class="string">'Ann'</span>, <span class="string">'Eason'</span>, <span class="string">'Luis'</span>, <span class="string">'Edware'</span>, <span class="string">'Ann'</span>, <span class="string">'Eason'</span>, <span class="string">'Luis'</span>, <span class="string">'Edware'</span>];</div><div class="line">print_r($array);</div><div class="line"></div><div class="line">$unique = array_unique($array);</div><div class="line">print_r($unique);</div><div class="line"></div><div class="line">$unique2 = [];</div><div class="line"><span class="keyword">foreach</span> ($array <span class="keyword">as</span> $item) &#123;</div><div class="line">    <span class="keyword">if</span> (!in_array($item, $unique2)) &#123;</div><div class="line">        $unique2[] = $item;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">print_r($unique2);</div></pre></td></tr></table></figure>
<h2 id="4-22-对数组中的各个元素应用一个函数"><a href="#4-22-对数组中的各个元素应用一个函数" class="headerlink" title="4.22 对数组中的各个元素应用一个函数"></a>4.22 对数组中的各个元素应用一个函数</h2><h4 id="问题-15"><a href="#问题-15" class="headerlink" title="问题"></a>问题</h4><p>希望对数组中的各个元素应用一个函数或方法，这就允许一次转换所有输入数据</p>
<h4 id="实现-15"><a href="#实现-15" class="headerlink" title="实现"></a>实现</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"></div><div class="line">$names = [</div><div class="line">    <span class="string">'firstName'</span> =&gt; <span class="string">'Ann‘Eason'</span>,</div><div class="line">    <span class="string">'lastName'</span> =&gt; <span class="string">'Luis’Edware'</span>,</div><div class="line">];</div><div class="line"></div><div class="line"></div><div class="line">array_walk($names, <span class="function"><span class="keyword">function</span><span class="params">(&amp;$value, $key)</span> </span>&#123;</div><div class="line">    $value = htmlentities($value, ENT_QUOTES);</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="keyword">foreach</span> ($names <span class="keyword">as</span> $name) &#123;</div><div class="line">    <span class="keyword">echo</span> $name . <span class="string">"\n"</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">echo</span> <span class="string">'****************************************'</span> . <span class="string">"\n"</span>;</div><div class="line"></div><div class="line"><span class="comment">// 对于嵌套数据，可以使用 array_walk_recursive()</span></div><div class="line">$names = [</div><div class="line">    <span class="string">'firstName'</span> =&gt; [<span class="string">'Ann"'</span>, <span class="string">'Luis"'</span>],</div><div class="line">    <span class="string">'lastName'</span> =&gt; [<span class="string">'"Eason'</span>, <span class="string">'"Edware'</span>],</div><div class="line">];</div><div class="line"></div><div class="line">array_walk_recursive($names, <span class="function"><span class="keyword">function</span><span class="params">(&amp;$value, $key)</span> </span>&#123;</div><div class="line">    $value = htmlentities($value, ENT_QUOTES);</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="keyword">foreach</span> ($names <span class="keyword">as</span> $name) &#123;</div><div class="line">    <span class="keyword">foreach</span> ($name <span class="keyword">as</span> $item) &#123;</div><div class="line">        <span class="keyword">echo</span> $item . <span class="string">"\n"</span>;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="4-23-查找两个数组的并集、交集或差集"><a href="#4-23-查找两个数组的并集、交集或差集" class="headerlink" title="4.23 查找两个数组的并集、交集或差集"></a>4.23 查找两个数组的并集、交集或差集</h2><h4 id="问题-16"><a href="#问题-16" class="headerlink" title="问题"></a>问题</h4><p>有两个数组，希望找出它们的并集、交集、差集和对称差集</p>
<h4 id="实现-16"><a href="#实现-16" class="headerlink" title="实现"></a>实现</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"></div><div class="line">$a = range(<span class="string">'a'</span>, <span class="string">'n'</span>);</div><div class="line">$b = range(<span class="string">'h'</span>, <span class="string">'t'</span>);</div><div class="line"><span class="comment">// 要计算并集</span></div><div class="line">$union = array_unique(array_merge($a, $b));</div><div class="line">print_r($union);</div><div class="line"></div><div class="line"><span class="comment">// 要计算交集</span></div><div class="line">$intersection = array_intersect($a, $b);</div><div class="line">print_r($intersection);</div><div class="line"></div><div class="line"><span class="comment">// 简单差集</span></div><div class="line">$difference1 = array_diff($a, $b);</div><div class="line">$difference2 = array_diff($b, $a);</div><div class="line">print_r($difference1);</div><div class="line">print_r($difference2);</div><div class="line"></div><div class="line"><span class="comment">// 对称差集</span></div><div class="line">$difference = array_merge(array_diff($a, $b), array_diff($b, $a));</div><div class="line">print_r($difference);</div></pre></td></tr></table></figure>
<h2 id="4-24-高效迭代处理大型数据集"><a href="#4-24-高效迭代处理大型数据集" class="headerlink" title="4.24 高效迭代处理大型数据集"></a>4.24 高效迭代处理大型数据集</h2><h4 id="问题-17"><a href="#问题-17" class="headerlink" title="问题"></a>问题</h4><p>希望迭代处理一个元素列表，不过整个列表会占用大量内存，或者生成整个列表的速度非常慢。</p>
<h4 id="实现-17"><a href="#实现-17" class="headerlink" title="实现"></a>实现</h4><h2 id="4-25-使用数组语法访问对象"><a href="#4-25-使用数组语法访问对象" class="headerlink" title="4.25 使用数组语法访问对象"></a>4.25 使用数组语法访问对象</h2><h4 id="问题-18"><a href="#问题-18" class="headerlink" title="问题"></a>问题</h4><p>有一个对象，不过希望它作为一个数组来读写数据。这样不仅可以得到面向对象设计的好处，还可以利用我们熟悉的数组接口</p>
<h4 id="实现-18"><a href="#实现-18" class="headerlink" title="实现"></a>实现</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">FakeArray</span> <span class="keyword">implements</span> <span class="title">ArrayAccess</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">private</span> $elements;</div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span><span class="params">()</span></span></div><div class="line">    &#123;</div><div class="line">        <span class="keyword">$this</span>-&gt;elements = [];</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">offsetExists</span><span class="params">($offset)</span></span></div><div class="line">    &#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;elements[$offset]);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">offsetGet</span><span class="params">($offset)</span></span></div><div class="line">    &#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;elements[$offset];</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">offsetSet</span><span class="params">($offset, $value)</span></span></div><div class="line">    &#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;elements[$offset] = $value;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">offsetUnset</span><span class="params">($offset)</span></span></div><div class="line">    &#123;</div><div class="line">        <span class="keyword">unset</span>(<span class="keyword">$this</span>-&gt;elements[$offset]);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">$array = <span class="keyword">new</span> FakeArray;</div><div class="line">$array[<span class="string">'animal'</span>] = <span class="string">"wabbit"</span>;</div><div class="line"></div><div class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($array[<span class="string">'animal'</span>]) &amp;&amp; $array[<span class="string">'animal'</span>] == <span class="string">'wabbit'</span>) &#123;</div><div class="line">    <span class="keyword">unset</span>($array[<span class="string">'animal'</span>]);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">if</span> (!<span class="keyword">isset</span>($array[<span class="string">'animal'</span>])) &#123;</div><div class="line">    <span class="keyword">print</span> <span class="string">"Well,What did you expect in an"</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://luisedware.github.io/2017/01/22/PHP-Codebook-四/" data-id="cj3gyqvb50027xo4b5gcj99we" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/PHP/">PHP</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-PHP-Codebook-二" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/01/22/PHP-Codebook-二/" class="article-date">
  <time datetime="2017-01-22T03:38:37.000Z" itemprop="datePublished">2017-01-22</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/PHP/">PHP</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/01/22/PHP-Codebook-二/">PHP Codebook(二)</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="2-1-检查变量是否包含一个合法数字"><a href="#2-1-检查变量是否包含一个合法数字" class="headerlink" title="2.1 检查变量是否包含一个合法数字"></a>2.1 检查变量是否包含一个合法数字</h2><h4 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h4><p>希望确保变量包含一个数（即使变量的类型是字符串），或者希望检查变量不仅是一个数，而且要特别指定其类型是一个数字类型。</p>
<h4 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line">    <span class="keyword">foreach</span> ([<span class="number">5</span>,<span class="string">'5'</span>,<span class="string">'05'</span>,<span class="number">12.3</span>,<span class="string">'16.7'</span>,<span class="string">'five'</span>,oxDECAFBAD,<span class="string">'10e2000'</span>] <span class="keyword">as</span> $maybeNumber) &#123;</div><div class="line">        $isItNumeric = is_numeric($maybeNumber);</div><div class="line">        $actualType = gettype($maybeNumber);</div><div class="line">        $string = <span class="string">"Is the $actualType $maybeNumber numeric?"</span>;</div><div class="line"></div><div class="line">        <span class="keyword">if</span>(is_numeric($maybeNumber))&#123;</div><div class="line">            $answer = <span class="string">"yes"</span>;</div><div class="line">        &#125;<span class="keyword">else</span>&#123;</div><div class="line">            $answer = <span class="string">"no"</span>;</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="keyword">echo</span> pack(<span class="string">"A40A3"</span>,$string,$answer).<span class="string">"\n"</span>;</div><div class="line">    &#125;</div><div class="line"><span class="meta">?&gt;</span></div><div class="line"><span class="comment">/*</span></div><div class="line">Is the integer 5 numeric?               yes</div><div class="line">Is the string 5 numeric?                yes</div><div class="line">Is the string 05 numeric?               yes</div><div class="line">Is the double 12.3 numeric?             yes</div><div class="line">Is the string 16.7 numeric?             yes</div><div class="line">Is the string five numeric?             no</div><div class="line">Is the string oxDECAFBAD numeric?       no</div><div class="line">Is the string 10e2000 numeric?          yes</div><div class="line">*/</div></pre></td></tr></table></figure>
<h2 id="2-2-比较浮点数"><a href="#2-2-比较浮点数" class="headerlink" title="2.2 比较浮点数"></a>2.2 比较浮点数</h2><h4 id="问题-1"><a href="#问题-1" class="headerlink" title="问题"></a>问题</h4><p>希望检查两个浮点数是否相等</p>
<h4 id="实现-1"><a href="#实现-1" class="headerlink" title="实现"></a>实现</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line">$delta = <span class="number">0.00001</span>;</div><div class="line">$a = <span class="number">1.00000001</span>;</div><div class="line">$b = <span class="number">1.00000000</span>;</div><div class="line"></div><div class="line"><span class="keyword">if</span>(abs($a - $b) &lt; $delta)&#123;</div><div class="line">    <span class="keyword">print</span> <span class="string">"$a and $b are equal enough"</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="2-3-浮点数舍入"><a href="#2-3-浮点数舍入" class="headerlink" title="2.3 浮点数舍入"></a>2.3 浮点数舍入</h2><h4 id="问题-2"><a href="#问题-2" class="headerlink" title="问题"></a>问题</h4><p>希望舍入一个浮点数，可能取整为一个整数，或者舍入为指定的小数位数</p>
<h4 id="实现-2"><a href="#实现-2" class="headerlink" title="实现"></a>实现</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"></div><div class="line"><span class="comment">// 四舍五入 round()</span></div><div class="line"><span class="keyword">echo</span> round(<span class="number">2.4</span>) . <span class="string">"\n"</span>;</div><div class="line"><span class="keyword">echo</span> round(<span class="number">2.5</span>) . <span class="string">"\n"</span>;</div><div class="line"></div><div class="line"><span class="comment">// 向上取整</span></div><div class="line"><span class="keyword">echo</span> ceil(<span class="number">2.4</span>) . <span class="string">"\n"</span>;</div><div class="line"></div><div class="line"><span class="comment">// 向下取整</span></div><div class="line"><span class="keyword">echo</span> floor(<span class="number">2.9</span>) . <span class="string">"\n"</span>;</div><div class="line"></div><div class="line"><span class="comment">// 一个数正好落在两个整数中间的位置，PHP 会向远离 0 的方向取整</span></div><div class="line"><span class="keyword">echo</span> round(<span class="number">2.5</span>) . <span class="string">"\n"</span>;</div><div class="line"><span class="keyword">echo</span> round(<span class="number">-2.5</span>) . <span class="string">"\n"</span>;</div><div class="line"><span class="keyword">echo</span> round(<span class="number">2.4</span>) . <span class="string">"\n"</span>;</div><div class="line"><span class="keyword">echo</span> round(<span class="number">-2.4</span>) . <span class="string">"\n"</span>;</div><div class="line"></div><div class="line"><span class="keyword">echo</span> ceil(<span class="number">2.5</span>) . <span class="string">"\n"</span>;</div><div class="line"><span class="keyword">echo</span> ceil(<span class="number">-2.5</span>) . <span class="string">"\n"</span>;</div><div class="line"><span class="keyword">echo</span> ceil(<span class="number">2.4</span>) . <span class="string">"\n"</span>;</div><div class="line"><span class="keyword">echo</span> ceil(<span class="number">-2.4</span>) . <span class="string">"\n"</span>;</div><div class="line"></div><div class="line"><span class="keyword">echo</span> floor(<span class="number">2.5</span>) . <span class="string">"\n"</span>;</div><div class="line"><span class="keyword">echo</span> floor(<span class="number">-2.5</span>) . <span class="string">"\n"</span>;</div><div class="line"><span class="keyword">echo</span> floor(<span class="number">2.4</span>) . <span class="string">"\n"</span>;</div><div class="line"><span class="keyword">echo</span> floor(<span class="number">-2.4</span>) . <span class="string">"\n"</span>;</div></pre></td></tr></table></figure>
<h2 id="2-4-处理一系列整数"><a href="#2-4-处理一系列整数" class="headerlink" title="2.4 处理一系列整数"></a>2.4 处理一系列整数</h2><h4 id="问题-3"><a href="#问题-3" class="headerlink" title="问题"></a>问题</h4><p>希望对一个整数范围应用一段代码</p>
<h4 id="实现-3"><a href="#实现-3" class="headerlink" title="实现"></a>实现</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 使用 range() 函数实现</span></div><div class="line"><span class="meta">&lt;?php</span></div><div class="line"><span class="keyword">foreach</span> (range(<span class="number">0</span>, <span class="number">100</span>, <span class="number">5</span>) <span class="keyword">as</span> $number) &#123;</div><div class="line">    <span class="keyword">echo</span> $number . <span class="string">"\n"</span>;</div><div class="line">    printf(<span class="string">"%d squared is %d\n"</span>, $number, $number * $number);</div><div class="line">    printf(<span class="string">"%d cubed is %d\n"</span>, $number, $number * $number * $number);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="2-5-在指定范围内生成随机数"><a href="#2-5-在指定范围内生成随机数" class="headerlink" title="2.5 在指定范围内生成随机数"></a>2.5 在指定范围内生成随机数</h2><h4 id="问题-4"><a href="#问题-4" class="headerlink" title="问题"></a>问题</h4><p>希望在指定的数字范围内生成一个随机数</p>
<h4 id="实现-4"><a href="#实现-4" class="headerlink" title="实现"></a>实现</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line">$lower = <span class="number">0</span>;</div><div class="line">$upper = <span class="number">1024</span>;</div><div class="line">$randNumber = mt_rand($lower, $upper);</div><div class="line"></div><div class="line"><span class="keyword">echo</span> $randNumber;</div></pre></td></tr></table></figure>
<h2 id="2-6-生成可预测的随机数"><a href="#2-6-生成可预测的随机数" class="headerlink" title="2.6 生成可预测的随机数"></a>2.6 生成可预测的随机数</h2><h4 id="问题-5"><a href="#问题-5" class="headerlink" title="问题"></a>问题</h4><p>希望生成可预测的随机数，从而可以保证可重复的行为</p>
<h4 id="实现-5"><a href="#实现-5" class="headerlink" title="实现"></a>实现</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">pick_color</span><span class="params">()</span></span></div><div class="line">&#123;</div><div class="line">    $colors = [<span class="string">'red'</span>, <span class="string">'orange'</span>, <span class="string">'yellow'</span>, <span class="string">'blue'</span>, <span class="string">'green'</span>, <span class="string">'indigo'</span>, <span class="string">'violet'</span>];</div><div class="line">    $i = mt_rand(<span class="number">0</span>, count($colors) - <span class="number">1</span>);</div><div class="line"></div><div class="line">    <span class="keyword">return</span> $colors[$i];</div><div class="line">&#125;</div><div class="line"></div><div class="line">mt_srand(<span class="number">34534</span>);</div><div class="line">$first = pick_color();</div><div class="line">$second = pick_color();</div><div class="line"></div><div class="line"><span class="keyword">print</span> <span class="string">"$first is red and $second is yellow"</span>;</div></pre></td></tr></table></figure>
<h2 id="2-10-格式化数字"><a href="#2-10-格式化数字" class="headerlink" title="2.10 格式化数字"></a>2.10 格式化数字</h2><h4 id="问题-6"><a href="#问题-6" class="headerlink" title="问题"></a>问题</h4><p>希望输出一个数，要包括千分位分隔符和小数点。</p>
<h4 id="实现-6"><a href="#实现-6" class="headerlink" title="实现"></a>实现</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line">$number = <span class="number">1234.56</span>;</div><div class="line"><span class="comment">// 千位分隔符</span></div><div class="line"><span class="keyword">echo</span> number_format($number) . <span class="string">"\n"</span>;</div><div class="line"></div><div class="line"><span class="comment">// 第二个参数指定使用了小数位数</span></div><div class="line"><span class="keyword">echo</span> number_format($number, <span class="number">2</span>) . <span class="string">"\n"</span>;</div><div class="line"></div><div class="line"><span class="comment">// 第三个参数指定小数点字符，第四个参数指定千位分隔符</span></div><div class="line"><span class="keyword">echo</span> number_format($number, <span class="number">2</span>, <span class="string">"@"</span>, <span class="string">'#'</span>) . <span class="string">"\n"</span>;</div></pre></td></tr></table></figure>
<h2 id="2-16-转换进制"><a href="#2-16-转换进制" class="headerlink" title="2.16 转换进制"></a>2.16 转换进制</h2><h4 id="问题-7"><a href="#问题-7" class="headerlink" title="问题"></a>问题</h4><p>需要将一个数从一个进制转换为另一个进制</p>
<h4 id="实现-7"><a href="#实现-7" class="headerlink" title="实现"></a>实现</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"><span class="comment">// 十六进制</span></div><div class="line">$hex = <span class="string">'a1'</span>;</div><div class="line"></div><div class="line"><span class="comment">// 从十六进制转换为十进制</span></div><div class="line">$decimal = base_convert($hex, <span class="number">16</span>, <span class="number">10</span>) . <span class="string">"\n"</span>;</div><div class="line"><span class="keyword">echo</span> $decimal;</div><div class="line"></div><div class="line">$decimal = <span class="number">1024</span>;</div><div class="line"><span class="keyword">echo</span> base_convert($decimal, <span class="number">10</span>, <span class="number">2</span>) . <span class="string">"\n"</span>;</div><div class="line"><span class="keyword">echo</span> base_convert($decimal, <span class="number">10</span>, <span class="number">8</span>) . <span class="string">"\n"</span>;</div><div class="line"><span class="keyword">echo</span> base_convert($decimal, <span class="number">10</span>, <span class="number">16</span>);</div></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://luisedware.github.io/2017/01/22/PHP-Codebook-二/" data-id="cj3gyqvb10022xo4bzbauwpyw" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/PHP/">PHP</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-PHP-Codebook-一" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/01/22/PHP-Codebook-一/" class="article-date">
  <time datetime="2017-01-21T22:06:56.000Z" itemprop="datePublished">2017-01-22</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/PHP/">PHP</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/01/22/PHP-Codebook-一/">PHP Codebook(一)</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="1-1-访问子串"><a href="#1-1-访问子串" class="headerlink" title="1.1 访问子串"></a>1.1 访问子串</h2><h4 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h4><p>想知道一个字符串是否包含一个特定的子串。例如，想查看一个 email 地址是否包含一个 @</p>
<h4 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line">$string = <span class="string">'506510463@qq.com'</span>;</div><div class="line"></div><div class="line"><span class="keyword">if</span> (($length = strpos($string, <span class="string">'@'</span>)) === <span class="keyword">false</span>) &#123;</div><div class="line">    <span class="keyword">echo</span> <span class="string">'There was no @ in the e-mail address'</span>;</div><div class="line">&#125; <span class="keyword">else</span> &#123;</div><div class="line">    <span class="keyword">echo</span> <span class="string">'This is a right e-mail address-'</span> . $length;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>strpos 找到子串时，会返回子串的位置。找不到子串时，会返回 false，为了区分 0 和 false，必须使用 恒等操作符或非恒等操作符来进行判断。</p>
<h2 id="1-2-抽取子串"><a href="#1-2-抽取子串" class="headerlink" title="1.2 抽取子串"></a>1.2 抽取子串</h2><h4 id="问题-1"><a href="#问题-1" class="headerlink" title="问题"></a>问题</h4><p>希望从字符串中的某个特定位置开始抽取这个字符串的一部分。例如，对于输入到一个表单的用户名，想要得到这个用户名的前八位字符。</p>
<h4 id="实现-1"><a href="#实现-1" class="headerlink" title="实现"></a>实现</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line">$start = <span class="number">0</span>;</div><div class="line">$length = <span class="number">8</span>;</div><div class="line">$string = <span class="string">"LuisEdware"</span>;</div><div class="line"></div><div class="line"><span class="keyword">echo</span> substr($string, $start, $length) . <span class="string">"\n"</span>;</div><div class="line"><span class="comment">// LuisEdwa</span></div><div class="line"></div><div class="line"><span class="comment">// 如果忽略 $length，substr() 会返回从 $start 到原字符串末尾的子串</span></div><div class="line">$start = <span class="number">5</span>;</div><div class="line"><span class="keyword">echo</span> substr($string, $start) . <span class="string">"\n"</span>;</div><div class="line"><span class="comment">// dware</span></div><div class="line"></div><div class="line"><span class="comment">// 如果 $start 大于字符串的长度，substr() 将返回 false</span></div><div class="line">$start = <span class="number">20</span>;</div><div class="line">var_dump(substr($string, $start));</div><div class="line"><span class="comment">// false</span></div><div class="line"></div><div class="line"><span class="comment">// 如果 $start 加 $length 超过了字符串末尾，substr() 将返回从 $start 开始至字符串末尾的所有字符</span></div><div class="line"><span class="keyword">echo</span> substr($string, <span class="number">8</span>, <span class="number">5</span>) . <span class="string">"\n"</span>;</div><div class="line"><span class="comment">// re</span></div><div class="line"></div><div class="line"><span class="comment">// 如果 $start 为负数，substr() 会从字符串末尾倒数来确定子串从哪里开始</span></div><div class="line"><span class="keyword">echo</span> substr($string, <span class="number">-6</span>) . <span class="string">"\n"</span>;</div><div class="line"><span class="comment">// Edware</span></div><div class="line"><span class="keyword">echo</span> substr($string, <span class="number">-6</span>, <span class="number">2</span>) . <span class="string">"\n"</span>;</div><div class="line"><span class="comment">// Ed</span></div><div class="line"></div><div class="line"><span class="comment">// 如果 $length 为负数，substr() 会从字符串末尾倒数来确定子串到哪里结束</span></div><div class="line"><span class="keyword">echo</span> substr($string, <span class="number">2</span>, <span class="number">-2</span>) . <span class="string">"\n"</span>;</div><div class="line"><span class="comment">// isEdwa</span></div><div class="line"><span class="keyword">echo</span> substr($string, <span class="number">-4</span>, <span class="number">-2</span>) . <span class="string">"\n"</span>;</div><div class="line"><span class="comment">// wa</span></div></pre></td></tr></table></figure>
<h2 id="1-3-替换子串"><a href="#1-3-替换子串" class="headerlink" title="1.3 替换子串"></a>1.3 替换子串</h2><h4 id="问题-2"><a href="#问题-2" class="headerlink" title="问题"></a>问题</h4><p>希望用另外一个不同的字符串来替换一个子串。例如，打印一个信用卡号之前，想要对除了后四位以外的部分模糊处理。或者当需要显示的文档过大，无法一次全部显示，可能希望显示一部分文本，另外还有一个链接指向其余的文本。</p>
<h4 id="实现-2"><a href="#实现-2" class="headerlink" title="实现"></a>实现</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line">$creditCard = <span class="string">"6217 0032 4000 0600 075"</span>;</div><div class="line"><span class="keyword">echo</span> substr_replace($creditCard, <span class="string">'****'</span>, <span class="number">0</span>, strlen($creditCard) - <span class="number">4</span>) . <span class="string">"\n"</span>;</div><div class="line"><span class="comment">// **** 075</span></div><div class="line"></div><div class="line"><span class="keyword">echo</span> substr_replace($creditCard, <span class="string">'**** **** **** ****'</span>, <span class="number">0</span>, strlen($creditCard) - <span class="number">4</span>) . <span class="string">"\n"</span>;</div><div class="line"><span class="comment">// **** **** **** **** 075</span></div><div class="line"></div><div class="line">$text = <span class="string">"Chief Justice Roberts, President Carter, President Clinton, President Bush, President Obama, fellow Americans and people of the world, thank you.</span></div><div class="line"></div><div class="line">We, the citizens of America, are now joined in a great national effort to rebuild our country and restore its promise for all of our people.";</div><div class="line"></div><div class="line"><span class="keyword">echo</span> substr_replace($text, <span class="string">"..."</span>, <span class="number">25</span>);</div></pre></td></tr></table></figure>
<h2 id="1-4-逐字节处理字符串"><a href="#1-4-逐字节处理字符串" class="headerlink" title="1.4 逐字节处理字符串"></a>1.4 逐字节处理字符串</h2><h4 id="问题-3"><a href="#问题-3" class="headerlink" title="问题"></a>问题</h4><p>需要分别处理字符串中的各个字节</p>
<h4 id="实现-3"><a href="#实现-3" class="headerlink" title="实现"></a>实现</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"></div><div class="line">$string = <span class="string">"This weekend,I am going shopping for pet chicken."</span>;</div><div class="line">$vowels = <span class="number">0</span>;</div><div class="line"></div><div class="line"><span class="keyword">for</span> ($i = <span class="number">0</span>, $j = strlen($string); $i &lt; $j; $i++) &#123;</div><div class="line">    <span class="keyword">if</span> (strstr(<span class="string">'aeiouAEIOU'</span>, $string[$i])) &#123;</div><div class="line">        $vowels++;</div><div class="line">        $string[$i] = ucwords($string[$i]);</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">echo</span> $vowels . <span class="string">"\n"</span>;</div><div class="line"><span class="keyword">echo</span> $string;</div></pre></td></tr></table></figure>
<h2 id="1-5-按单词或字节反转字符串"><a href="#1-5-按单词或字节反转字符串" class="headerlink" title="1.5 按单词或字节反转字符串"></a>1.5 按单词或字节反转字符串</h2><h4 id="问题-4"><a href="#问题-4" class="headerlink" title="问题"></a>问题</h4><p>希望反转一个字符串中的单词或字节</p>
<h4 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"></div><div class="line">$string = <span class="string">"This is not a palindrome"</span>;</div><div class="line"></div><div class="line"><span class="comment">// 按字节反转</span></div><div class="line"><span class="keyword">echo</span> strrev($string) . <span class="string">"\n"</span>;</div><div class="line"><span class="comment">// emordnilap a ton si sihT</span></div><div class="line"></div><div class="line"><span class="comment">// 按单词反转</span></div><div class="line">$string = <span class="string">"Hello World,My Name is Luis Edware."</span>;</div><div class="line"></div><div class="line"><span class="comment">// 将字符串分解为单词</span></div><div class="line">$words = explode(<span class="string">' '</span>, $string);</div><div class="line"></div><div class="line"><span class="comment">// 反转单词数组</span></div><div class="line">$words = array_reverse($words);</div><div class="line"></div><div class="line"><span class="comment">// 重新构建字符串</span></div><div class="line">$string = implode(<span class="string">' '</span>, $words);</div><div class="line"><span class="keyword">echo</span> $string;</div><div class="line"><span class="comment">// Edware. Luis is Name World,My Hello</span></div></pre></td></tr></table></figure>
<h2 id="1-6-生成随机字符串"><a href="#1-6-生成随机字符串" class="headerlink" title="1.6 生成随机字符串"></a>1.6 生成随机字符串</h2><h4 id="问题-5"><a href="#问题-5" class="headerlink" title="问题"></a>问题</h4><p>希望生成一个随机字符串</p>
<h4 id="实现-4"><a href="#实现-4" class="headerlink" title="实现"></a>实现</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">str_rand</span><span class="params">($length, $characters = null)</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">if</span> ($characters === <span class="keyword">null</span>) &#123;</div><div class="line">        $characters = <span class="string">'0123456789qwertyuiopasdfghjklzxcvbnm!@#$%^&amp;*()-=_+[]&#123;&#125;:";,.&lt;&gt;/?'</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">if</span> (!is_int($length) || $length &lt; <span class="number">0</span>) &#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    $charactersLength = strlen($characters);</div><div class="line">    $string = <span class="string">''</span>;</div><div class="line"></div><div class="line">    <span class="keyword">for</span> ($i = $length; $i &gt; <span class="number">0</span>; $i--) &#123;</div><div class="line">        $string .= $characters[mt_rand(<span class="number">0</span>, $charactersLength)];</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">return</span> $string;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">echo</span> str_rand(<span class="number">32</span>);</div></pre></td></tr></table></figure>
<h2 id="1-8-控制大小写"><a href="#1-8-控制大小写" class="headerlink" title="1.8 控制大小写"></a>1.8 控制大小写</h2><h4 id="问题-6"><a href="#问题-6" class="headerlink" title="问题"></a>问题</h4><p>需要将字符串中的字母全大写或全小写，或者改变字母的大小写。例如，希望名字中的首字母大写，而其余字母都为小写。</p>
<h4 id="实现-5"><a href="#实现-5" class="headerlink" title="实现"></a>实现</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"><span class="comment">// 使用 ucfirst() 或 ucwords() 将一个单词或多个单词中的首字母大写</span></div><div class="line">$string = <span class="string">"my name is Luis edware"</span>;</div><div class="line"><span class="keyword">echo</span> ucfirst($string) . <span class="string">"\n"</span>;</div><div class="line"><span class="keyword">echo</span> ucwords($string) . <span class="string">"\n"</span>;</div><div class="line"></div><div class="line"><span class="comment">// strtoupper()、strtolower() 将作用整个字符串</span></div><div class="line"><span class="keyword">echo</span> strtoupper($string) . <span class="string">"\n"</span>;</div><div class="line"><span class="keyword">echo</span> strtolower($string);</div></pre></td></tr></table></figure>
<h2 id="1-10-去除字符串首尾的空格"><a href="#1-10-去除字符串首尾的空格" class="headerlink" title="1.10 去除字符串首尾的空格"></a>1.10 去除字符串首尾的空格</h2><h4 id="问题-7"><a href="#问题-7" class="headerlink" title="问题"></a>问题</h4><p>希望从字符串开头和末尾删除空白符。例如，在验证用户输入之前，可能希望先完成清理。</p>
<h4 id="实现-6"><a href="#实现-6" class="headerlink" title="实现"></a>实现</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"><span class="comment">/**</span></div><div class="line"> * ltrim() 函数从字符串开头删除空白符</div><div class="line"> * rtrim() 函数从字符串末尾删除空白符</div><div class="line"> * trim() 函数则删除字符串开头和末尾的空白符</div><div class="line"> */</div><div class="line"></div><div class="line">$lString = <span class="string">"    LuisEdware"</span>;</div><div class="line">$rString = <span class="string">"LuisEdware    "</span>;</div><div class="line">$string = <span class="string">"    LuisEdware    "</span>;</div><div class="line"></div><div class="line"><span class="keyword">echo</span> ltrim($lString) . <span class="string">"\n"</span>;</div><div class="line"><span class="keyword">echo</span> rtrim($rString) . <span class="string">"\n"</span>;</div><div class="line"><span class="keyword">echo</span> trim($string) . <span class="string">"\n"</span>;</div><div class="line"></div><div class="line"><span class="comment">// trim() 函数还可以从字符串中删除用户指定的字符。</span></div><div class="line"><span class="keyword">echo</span> ltrim(<span class="string">'506510463 2794408425 Luis Edware'</span>, <span class="string">'0..9'</span>) . <span class="string">"\n"</span>;</div><div class="line"><span class="keyword">echo</span> rtrim(<span class="string">'LuisEdware 5065104632794408425'</span>, <span class="string">'0..9'</span>) . <span class="string">"\n"</span>;</div></pre></td></tr></table></figure>
<h2 id="1-13-生成固定宽度字段数据记录"><a href="#1-13-生成固定宽度字段数据记录" class="headerlink" title="1.13 生成固定宽度字段数据记录"></a>1.13 生成固定宽度字段数据记录</h2><h4 id="问题-8"><a href="#问题-8" class="headerlink" title="问题"></a>问题</h4><p>需要格式化数据记录，使得每个字段占据指定数目的字符。</p>
<h4 id="实现-7"><a href="#实现-7" class="headerlink" title="实现"></a>实现</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"></div><div class="line">$books = [</div><div class="line">    [<span class="string">'trueName'</span>, <span class="string">'nickName'</span>, <span class="string">'birthday'</span>],</div><div class="line">    [<span class="string">'Elmer Gantry'</span>, <span class="string">'Sinclair Lewis'</span>, <span class="number">1927</span>],</div><div class="line">    [<span class="string">'The Scarlatti Inheritance'</span>, <span class="string">'Robert Ludlum'</span>, <span class="number">1971</span>],</div><div class="line">    [<span class="string">'The Parsifal Mosaic'</span>, <span class="string">'William Styron'</span>, <span class="number">1979</span>],</div><div class="line">];</div><div class="line"></div><div class="line"><span class="keyword">foreach</span> ($books <span class="keyword">as</span> $book) &#123;</div><div class="line">    <span class="keyword">print</span> pack(<span class="string">'A30A20A10'</span>, $book[<span class="number">0</span>], $book[<span class="number">1</span>], $book[<span class="number">2</span>]) . <span class="string">"\n"</span>;</div><div class="line">&#125;</div><div class="line"><span class="comment">/*</span></div><div class="line">trueName                      nickName            birthday</div><div class="line">Elmer Gantry                  Sinclair Lewis      1927</div><div class="line">The Scarlatti Inheritance     Robert Ludlum       1971</div><div class="line">The Parsifal Mosaic           William Styron      1979</div><div class="line"> */</div></pre></td></tr></table></figure>
<h2 id="1-15-分解字符串"><a href="#1-15-分解字符串" class="headerlink" title="1.15 分解字符串"></a>1.15 分解字符串</h2><h4 id="问题-9"><a href="#问题-9" class="headerlink" title="问题"></a>问题</h4><p>需要将一个字符串分解为片段。例如希望访问用户在一个 <textarea\> 表单域中输入的各行文本<br><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line">$string = <span class="string">'My sentence is not very complicated'</span>;</div><div class="line">$words = explode(<span class="string">' '</span>, $string);</div><div class="line"><span class="comment">/*</span></div><div class="line">Array</div><div class="line">(</div><div class="line">    [0] =&gt; My</div><div class="line">    [1] =&gt; sentence</div><div class="line">    [2] =&gt; is</div><div class="line">    [3] =&gt; not</div><div class="line">    [4] =&gt; very</div><div class="line">    [5] =&gt; complicated</div><div class="line">)</div><div class="line">*/</div></pre></td></tr></table></figure></textarea\></p>
<h2 id="1-16-使文本在指定行长度自动换行"><a href="#1-16-使文本在指定行长度自动换行" class="headerlink" title="1.16 使文本在指定行长度自动换行"></a>1.16 使文本在指定行长度自动换行</h2><h4 id="问题-10"><a href="#问题-10" class="headerlink" title="问题"></a>问题</h4><p>需要实现字符串自动换行</p>
<h4 id="实现-8"><a href="#实现-8" class="headerlink" title="实现"></a>实现</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line">$text = <span class="string">"Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Aenean eu leo quam. Pellentesque ornare sem lacinia quam venenatis vestibulum. Sed posuere consectetur est at lobortis. Cras mattis consectetur purus sit amet fermentum."</span>;</div><div class="line"></div><div class="line"><span class="keyword">echo</span> <span class="string">'&lt;pre&gt;'</span> . $text . <span class="string">'&lt;/pre&gt;'</span> . <span class="string">"\n"</span>;</div><div class="line"><span class="keyword">echo</span> wordwrap($text, <span class="number">50</span>);</div></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://luisedware.github.io/2017/01/22/PHP-Codebook-一/" data-id="cj3gyqvas001rxo4bqcpgzigy" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/PHP/">PHP</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-使用-Laravel-与-Vue-js-进行微信开发（三）" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/01/16/使用-Laravel-与-Vue-js-进行微信开发（三）/" class="article-date">
  <time datetime="2017-01-16T15:04:33.000Z" itemprop="datePublished">2017-01-16</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/PHP/">PHP</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/01/16/使用-Laravel-与-Vue-js-进行微信开发（三）/">使用 Laravel 与 Vue.js 进行微信开发（三）</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="目标"><a href="#目标" class="headerlink" title="目标"></a>目标</h2><p>本文的目标是实现微信公众号菜单的创建与删除</p>
<h2 id="创建路由"><a href="#创建路由" class="headerlink" title="创建路由"></a>创建路由</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/* 微信菜单创建 */</span></div><div class="line">Route::get(<span class="string">'/create-menus'</span>, [</div><div class="line">    <span class="string">'as'</span> =&gt; <span class="string">'wechat.create.menus'</span>,</div><div class="line">    <span class="string">'uses'</span> =&gt; <span class="string">'WeChatServerController@createMenus'</span>,</div><div class="line">]);</div><div class="line"></div><div class="line"><span class="comment">/* 微信菜单创建 */</span></div><div class="line">Route::get(<span class="string">'/destroy-menus'</span>, [</div><div class="line">    <span class="string">'as'</span> =&gt; <span class="string">'wechat.destroy.menus'</span>,</div><div class="line">    <span class="string">'uses'</span> =&gt; <span class="string">'WeChatServerController@destroyMenus'</span>,</div><div class="line">]);</div></pre></td></tr></table></figure>
<h2 id="修改控制器"><a href="#修改控制器" class="headerlink" title="修改控制器"></a>修改控制器</h2><p>修改控制器 app/Http/Controllers/WeChat/WeChatServerController.php，新增代码如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div></pre></td><td class="code"><pre><div class="line">/**</div><div class="line"> * 创建新的微信菜单</div><div class="line"> * @param WeChat $weChat</div><div class="line"> * @return string</div><div class="line"> */</div><div class="line">public function createMenus(WeChat $weChat)</div><div class="line">&#123;</div><div class="line">    $menu = $weChat-&gt;menu;</div><div class="line">    $buttons = [</div><div class="line">        [</div><div class="line">            &quot;type&quot; =&gt; &quot;view&quot;,</div><div class="line">            &quot;name&quot; =&gt; &quot;进入好答&quot;,</div><div class="line">            &quot;url&quot; =&gt; route(&apos;wechat.index&apos;),</div><div class="line">        ],</div><div class="line">        [</div><div class="line">            &quot;type&quot; =&gt; &quot;click&quot;,</div><div class="line">            &quot;name&quot; =&gt; &quot;听我唱歌&quot;,</div><div class="line">            &quot;key&quot; =&gt; &quot;K0001_LET_ME_SING_MY_SONG&quot;,</div><div class="line">        ],</div><div class="line">    ];</div><div class="line"></div><div class="line">    $json = $menu-&gt;add($buttons);</div><div class="line">    $result = json_decode($json, true);</div><div class="line"></div><div class="line">    if ($result[&apos;errcode&apos;] == 0 &amp;&amp; $result[&apos;errmsg&apos;] == &apos;ok&apos;) &#123;</div><div class="line">        echo &quot;创建菜单成功&quot;;</div><div class="line">    &#125; else &#123;</div><div class="line">        echo &quot;创建菜单失败&quot;;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">/**</div><div class="line"> * 删除所有微信菜单</div><div class="line"> * @param WeChat $weChat</div><div class="line"> * @return string</div><div class="line"> */</div><div class="line">public function destroyMenus(WeChat $weChat)</div><div class="line">&#123;</div><div class="line">    $result = $weChat-&gt;menu-&gt;destroy();</div><div class="line"></div><div class="line">    if ($result[&apos;errcode&apos;] == 0 &amp;&amp; $result[&apos;errmsg&apos;] == &apos;ok&apos;) &#123;</div><div class="line">        echo &quot;删除菜单成功&quot;;</div><div class="line">    &#125; else &#123;</div><div class="line">        echo &quot;删除菜单失败&quot;;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://luisedware.github.io/2017/01/16/使用-Laravel-与-Vue-js-进行微信开发（三）/" data-id="cj3gyqvck003sxo4b92dwb2g2" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Laravel/">Laravel</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-使用-Laravel-与-Vue-js-进行微信开发（二）" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/01/16/使用-Laravel-与-Vue-js-进行微信开发（二）/" class="article-date">
  <time datetime="2017-01-16T12:42:22.000Z" itemprop="datePublished">2017-01-16</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/PHP/">PHP</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/01/16/使用-Laravel-与-Vue-js-进行微信开发（二）/">使用 Laravel 与 Vue.js 进行微信开发（二）</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="目标"><a href="#目标" class="headerlink" title="目标"></a>目标</h2><p>本文的目标是实现微信用户授权，当用户进入 Web App 的时候，能够获取用户的信息。</p>
<h2 id="配置回调地址"><a href="#配置回调地址" class="headerlink" title="配置回调地址"></a>配置回调地址</h2><p>微信公众平台 -&gt; 开发者工具 -&gt; 公众平台测试帐号 -&gt; 测试号管理 -&gt; 体验接口权限表 -&gt; 功能服务 -&gt; 网页帐号 -&gt; 修改 -&gt; 填写回调域名，格式如：www.baidu.com</p>
<h2 id="修改配置文件"><a href="#修改配置文件" class="headerlink" title="修改配置文件"></a>修改配置文件</h2><p>可以修改文件 config/wechat.php ，也可以在 .env 文件进行配置</p>
<p>wechat.php 文件配置<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">/*</div><div class="line"> * OAuth 配置</div><div class="line"> *</div><div class="line"> * only_wechat_browser: 只在微信浏览器跳转</div><div class="line"> * scopes：公众平台（snsapi_userinfo / snsapi_base），开放平台：snsapi_login</div><div class="line"> * callback：OAuth授权完成后的回调页地址(如果使用中间件，则随便填写。。。)</div><div class="line"> */</div><div class="line"> &apos;oauth&apos; =&gt; [</div><div class="line">     &apos;only_wechat_browser&apos; =&gt; false,</div><div class="line">     &apos;scopes&apos;   =&gt; array_map(&apos;trim&apos;, explode(&apos;,&apos;, env(&apos;WECHAT_OAUTH_SCOPES&apos;, &apos;snsapi_userinfo&apos;))),</div><div class="line">     &apos;callback&apos; =&gt; env(&apos;WECHAT_OAUTH_CALLBACK&apos;, &apos;/examples/oauth_callback.php&apos;),</div><div class="line"> ],</div></pre></td></tr></table></figure></p>
<p>.env 文件配置<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">WECHAT_APPID=****</div><div class="line">WECHAT_SECRET=***</div><div class="line">WECHAT_TOKEN=****</div><div class="line">WECHAT_AES_KEY=</div><div class="line"></div><div class="line">WECHAT_OAUTH_SCOPES=snsapi_userinfo</div><div class="line">WECHAT_OAUTH_CALLBACK=/wechat/oauth-callback</div></pre></td></tr></table></figure></p>
<h2 id="新增路由"><a href="#新增路由" class="headerlink" title="新增路由"></a>新增路由</h2><p>修改文件 app/Http/Routes/wechat.php，代码如下：<br><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"><span class="comment">/* 处理微信发送消息 */</span></div><div class="line">Route::any(<span class="string">'/request-handler'</span>, <span class="string">'WeChatServerController@requestHandler'</span>);</div><div class="line"></div><div class="line"><span class="comment">/* 处理微信授权回调 */</span></div><div class="line">Route::any(<span class="string">'/oauth-callback'</span>, <span class="string">'WeChatServerController@oauthCallback'</span>);</div><div class="line"></div><div class="line"><span class="comment">/* 微信应用首页 */</span></div><div class="line">Route::get(<span class="string">'/'</span>, [</div><div class="line">    <span class="string">'as'</span> =&gt; <span class="string">'wechat.index'</span>,</div><div class="line">    <span class="string">'uses'</span> =&gt; <span class="string">'WeChatApplicationController@index'</span>,</div><div class="line">    <span class="string">'middleware'</span> =&gt; [],</div><div class="line">]);</div></pre></td></tr></table></figure></p>
<h2 id="关闭路由-CSRF"><a href="#关闭路由-CSRF" class="headerlink" title="关闭路由 CSRF"></a>关闭路由 CSRF</h2><p>修改文件 app/Http/Middleware/VerifyCSsrfToken.php，代码如下：<br><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">protected</span> $except = [</div><div class="line">	<span class="string">'/wechat/request-handler'</span>,</div><div class="line">	<span class="string">'/wechat/oauth-callback'</span></div><div class="line">];</div></pre></td></tr></table></figure></p>
<h2 id="获取授权"><a href="#获取授权" class="headerlink" title="获取授权"></a>获取授权</h2><h3 id="1-授权页面"><a href="#1-授权页面" class="headerlink" title="1.授权页面"></a>1.授权页面</h3><p>新增文件 app/Http/Controllers/WeChat/WeChatApplicationController.php，代码如下：<br><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"></div><div class="line"><span class="keyword">namespace</span> <span class="title">App</span>\<span class="title">Http</span>\<span class="title">Controllers</span>\<span class="title">WeChat</span>;</div><div class="line"></div><div class="line"><span class="keyword">use</span> <span class="title">Illuminate</span>\<span class="title">Http</span>\<span class="title">Request</span>;</div><div class="line"><span class="keyword">use</span> <span class="title">App</span>\<span class="title">Http</span>\<span class="title">Controllers</span>\<span class="title">Controller</span>;</div><div class="line"><span class="keyword">use</span> <span class="title">EasyWeChat</span>\<span class="title">Foundation</span>\<span class="title">Application</span> <span class="title">as</span> <span class="title">WeChat</span>;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">WeChatApplicationController</span> <span class="keyword">extends</span> <span class="title">Controller</span></span></div><div class="line">&#123;</div><div class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">index</span><span class="params">(Request $request, WeChat $wechat)</span></span></div><div class="line">    &#123;</div><div class="line">    	<span class="comment">// 如果 Session 中没有用户信息，则跳转至微信授权页面</span></div><div class="line">        <span class="keyword">if</span> (<span class="keyword">empty</span>($request-&gt;session()-&gt;has(<span class="string">'weChatUserInfo'</span>))) &#123;</div><div class="line">            $oauth = $wechat-&gt;oauth;</div><div class="line"></div><div class="line">            <span class="keyword">return</span> $oauth-&gt;redirect();</div><div class="line">        &#125;</div><div class="line">        $user = $request-&gt;session()-&gt;get(<span class="string">'weChatUserInfo'</span>);</div><div class="line">        dump($user);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="2-回调操作"><a href="#2-回调操作" class="headerlink" title="2.回调操作"></a>2.回调操作</h3><p>修改文件 app/Http/Controllers/WeChat/WeChatServerController.php，代码如下：<br><figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;?php</span></div><div class="line"><span class="comment">/**</span></div><div class="line"> * 微信用户授权回调</div><div class="line"> * <span class="doctag">@param</span> Request $request</div><div class="line"> * <span class="doctag">@param</span> WeChat $weChat</div><div class="line"> * <span class="doctag">@return</span> \Illuminate\Http\RedirectResponse</div><div class="line"> */</div><div class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">oauthCallback</span><span class="params">(Request $request, WeChat $weChat)</span></span></div><div class="line">&#123;</div><div class="line">    $oauth = $weChat-&gt;oauth;</div><div class="line">    $user = $oauth-&gt;user();</div><div class="line">    $request-&gt;session()-&gt;put(<span class="string">'weChatUserInfo'</span>, $user-&gt;toArray());</div><div class="line"></div><div class="line">    <span class="keyword">return</span> redirect()-&gt;route(<span class="string">'wechat.index'</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="3-访问首页"><a href="#3-访问首页" class="headerlink" title="3.访问首页"></a>3.访问首页</h3><p>下载微信的 Web 开发者工具，在工具中访问授权首页，比如访问:你的域名/wechat,可以跳转至授权页，如下图：<br><img src="http://o93kt6djh.bkt.clouddn.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202017-01-16%2022.24.46.png" alt=""><br><img src="http://o93kt6djh.bkt.clouddn.com/%E5%B1%8F%E5%B9%95%E5%BF%AB%E7%85%A7%202017-01-16%2022.25.06.png" alt=""></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://luisedware.github.io/2017/01/16/使用-Laravel-与-Vue-js-进行微信开发（二）/" data-id="cj3gyqvcq0042xo4bkgtow483" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Laravel/">Laravel</a></li></ul>

    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    <a class="extend prev" rel="prev" href="/page/2/">&laquo; __('prev')</a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span><a class="page-number" href="/page/4/">4</a><a class="page-number" href="/page/5/">5</a><span class="space">&hellip;</span><a class="page-number" href="/page/8/">8</a><a class="extend next" rel="next" href="/page/4/">__('next') &raquo;</a>
  </nav>
</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Kategorier</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Apache/">Apache</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Design-Patterns/">Design Patterns</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Javascript/">Javascript</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Linux/">Linux</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/MySQL/">MySQL</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/PHP/">PHP</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Pattern/">Pattern</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Tooling/">Tooling</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/UML/">UML</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/AliCloud/">AliCloud</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Apache/">Apache</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Javascript/">Javascript</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Laravel/">Laravel</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Learning/">Learning</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Linux/">Linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MySQL/">MySQL</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/PHP/">PHP</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/PHPStorm/">PHPStorm</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Pattern/">Pattern</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Sublime-Text-3/">Sublime Text 3</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Swagger/">Swagger</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Swoole/">Swoole</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/UML/">UML</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Yii/">Yii</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Yii2/">Yii2</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/AliCloud/" style="font-size: 11.43px;">AliCloud</a> <a href="/tags/Apache/" style="font-size: 10px;">Apache</a> <a href="/tags/Javascript/" style="font-size: 11.43px;">Javascript</a> <a href="/tags/Laravel/" style="font-size: 18.57px;">Laravel</a> <a href="/tags/Learning/" style="font-size: 10px;">Learning</a> <a href="/tags/Linux/" style="font-size: 17.14px;">Linux</a> <a href="/tags/MySQL/" style="font-size: 15.71px;">MySQL</a> <a href="/tags/PHP/" style="font-size: 20px;">PHP</a> <a href="/tags/PHPStorm/" style="font-size: 11.43px;">PHPStorm</a> <a href="/tags/Pattern/" style="font-size: 12.86px;">Pattern</a> <a href="/tags/Sublime-Text-3/" style="font-size: 10px;">Sublime Text 3</a> <a href="/tags/Swagger/" style="font-size: 10px;">Swagger</a> <a href="/tags/Swoole/" style="font-size: 10px;">Swoole</a> <a href="/tags/UML/" style="font-size: 11.43px;">UML</a> <a href="/tags/Yii/" style="font-size: 14.29px;">Yii</a> <a href="/tags/Yii2/" style="font-size: 10px;">Yii2</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Arkiv</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/06/">June 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/05/">May 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/04/">April 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/03/">March 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/02/">February 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/01/">January 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/12/">December 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/11/">November 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/10/">October 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/09/">September 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/08/">August 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/06/">June 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/04/">April 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/03/">March 2016</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Siste innlegg</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2017/06/02/MySQLDumpSlow-的参数讲解与基础使用/">MySQLDumpSlow 的参数讲解与基础使用</a>
          </li>
        
          <li>
            <a href="/2017/06/01/XHprof-的安装配置与使用分析/">XHProf 的安装配置与使用分析</a>
          </li>
        
          <li>
            <a href="/2017/05/31/学习-Swoole/">学习 Swoole</a>
          </li>
        
          <li>
            <a href="/2017/05/27/ApacheBench-的参数讲解与基础使用/">ApacheBench 参数讲解与基础使用</a>
          </li>
        
          <li>
            <a href="/2017/05/25/高性能的-PHP-日志系统/">高性能的 PHP 日志系统</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2017 Luis Edware<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>